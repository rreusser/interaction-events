!function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var f="function"==typeof require&&require;if(!u&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";function r(){this.position=[0,0],this.touch=null}function i(e,t){function n(e,t){return e.preventDefault=t.preventDefault.bind(t),e.stopPropagation=t.stopPropagation.bind(t),e}function i(e){D.type="wheel",D.buttons=O,D.mods=S,D.x0=e.x,D.y0=e.y,D.dx=e.deltaX,D.dy=e.deltaY,D.dz=e.deltaZ,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,w.emit("interaction",n(D,e))}function c(e){g=o.x(e),v=o.y(e),D.type="mousedown",D.buttons=O,D.mods=S,D.x0=g,D.y0=v,D.dx=0,D.dy=0,D.dz=0,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,w.emit("interactionend",n(D,e))}function l(e){var t=o.x(e),r=o.y(e);D.type="mousemove",D.buttons=O,D.mods=S,D.x0=t,D.y0=r,D.dx=t-g,D.dy=r-v,D.dz=0,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,g=t,v=r,w.emit("interaction",n(D,e))}function p(e){for(var t=e.identifier,n=0;n<E.length;n++)if(E[n]&&E[n].touch&&E[n].touch.identifier===t)return n;return-1}function h(e){j=[null,null];for(var t=0;t<e.changedTouches.length;t++){var i=e.changedTouches[t],a=i.identifier,o=p(a);if(o===-1&&T<2){var u=0===T,s=E[0]?1:0,c=E[0]?0:1,l=new r;E[s]=l,T++,l.touch=i,f(i,k,l.position);E[c]?E[c].touch:void 0;u||(_=!1)}}T>0&&(D.type=1===T?"touchstart":"pinchstart",D.buttons=0,D.mods={},D.x0=0,D.y0=0,D.dx=0,D.dy=0,D.dz=0,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,w.emit("interactionstart",n(D,e)))}function d(e){for(var t,r=!1,i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];t=p(a),t!==-1&&(r=!0,E[t].touch=a,f(a,k,E[t].position))}if(r)if(1===T){for(t=0;t<E.length&&!E[t];t++);if(E[t]&&j[t]){var o=E[t].position[0],u=E[t].position[1],s=o-j[t][0],c=u-j[t][1];D.type="touch",D.buttons=0,D.mods={},D.x0=o,D.y0=u,D.dx=s,D.dy=c,D.dz=0,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,w.emit("interaction",n(D,e))}}else if(2===T&&j[0]&&j[1]){var l=j[0],h=j[1],d=h[0]-l[0],m=h[1]-l[1],b=E[0].position,y=E[1].position,g=y[0]-b[0],v=y[1]-b[1],x=Math.sqrt(d*d+m*m),A=Math.atan2(m,d),_=Math.sqrt(g*g+v*v),O=Math.atan2(v,g),S=.5*(h[0]+l[0]),C=.5*(h[1]+l[1]),s=.5*(y[0]+b[0]-l[0]-h[0]),c=.5*(y[1]+b[1]-l[1]-h[1]),z=_/x,L=O-A;D.type="pinch",D.buttons=0,D.mods={},D.x0=S,D.y0=C,D.dx=s,D.dy=c,D.dz=0,D.dsx=z,D.dsy=z,D.dsz=1,D.theta=O,D.dtheta=L,w.emit("interaction",n(D,e)),M=S,F=C}E[0]&&(j[0]=E[0].position.slice()),E[1]&&(j[1]=E[1].position.slice())}function m(e){for(var t=0;t<e.changedTouches.length;t++){var r=e.changedTouches[t],i=p(r);if(i!==-1){E[i]=null,T--;var a=0===i?1:0;E[a]?E[a].touch:void 0}}_||2===T||(_=!0),T<2&&(D.type=0===T?"touchend":"pinchend",D.buttons=0,D.mods={},D.x0=0,D.y0=0,D.dx=0,D.dy=0,D.dz=0,D.dsx=1,D.dsy=1,D.dsz=1,D.theta=0,D.dtheta=0,w.emit("interactionend",n(D,e)))}function b(){A||(A=!0,C.enabled=!0,k.addEventListener("wheel",i,!1),k.addEventListener("mousedown",c,!1),k.addEventListener("mousemove",l,!1),k.addEventListener("touchstart",h,!1),k.addEventListener("touchmove",d,!1),k.addEventListener("touchend",m,!1),k.addEventListener("touchcancel",m,!1))}function y(){A&&(A=!1,C.enabled=!1,k.removeEventListener("wheel",i,!1),k.removeEventListener("mousedown",c,!1),k.removeEventListener("mousemove",l,!1),k.removeEventListener("touchstart",h,!1),k.removeEventListener("touchmove",d,!1),k.removeEventListener("touchend",m,!1),k.removeEventListener("touchcancel",m,!1))}var g,v,x=a({element:window,constrainZoom:!1},e||{}),w=s({}),k=x.element,A=!1,j=[null,null],E=[null,null],_=!1,T=0,A=!1,D={},O=0,S={},C=u(k,function(e,t,n,r){O=e,S=r}),M=null,F=null;return b(),w.enable=b,w.disable=y,w}t.exports=i;var a=e("util-extend"),o=e("mouse-event"),u=e("mouse-change"),f=e("mouse-event-offset"),s=e("event-emitter")},{"event-emitter":2,"mouse-change":41,"mouse-event":43,"mouse-event-offset":42,"util-extend":51}],2:[function(e,t,n){"use strict";var r,i,a,o,u,f,s,c=e("d"),l=e("es5-ext/object/valid-callable"),p=Function.prototype.apply,h=Function.prototype.call,d=Object.create,m=Object.defineProperty,b=Object.defineProperties,y=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var n;return l(t),y.call(this,"__ee__")?n=this.__ee__:(n=g.value=d(null),m(this,"__ee__",g),g.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},i=function(e,t){var n,i;return l(t),i=this,r.call(this,e,n=function(){a.call(i,e,n),p.call(t,this,arguments)}),n.__eeOnceListener__=t,this},a=function(e,t){var n,r,i,a;if(l(t),!y.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if(r=n[e],"object"==typeof r)for(a=0;i=r[a];++a)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[a?0:1]:r.splice(a,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},o=function(e){var t,n,r,i,a;if(y.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,a=new Array(n-1),t=1;t<n;++t)a[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)p.call(r,this,a)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,a=new Array(n-1),t=1;t<n;++t)a[t-1]=arguments[t];p.call(i,this,a)}},u={on:r,once:i,off:a,emit:o},f={on:c(r),once:c(i),off:c(a),emit:c(o)},s=b({},f),t.exports=n=function(e){return null==e?d(s):b(Object(e),f)},n.methods=u},{d:3,"es5-ext/object/valid-callable":12}],3:[function(e,t,n){"use strict";var r,i=e("es5-ext/object/assign"),a=e("es5-ext/object/normalize-options"),o=e("es5-ext/object/is-callable"),u=e("es5-ext/string/#/contains");r=t.exports=function(e,t){var n,r,o,f,s;return arguments.length<2||"string"!=typeof e?(f=t,t=e,e=null):f=arguments[2],null==e?(n=o=!0,r=!1):(n=u.call(e,"c"),r=u.call(e,"e"),o=u.call(e,"w")),s={value:t,configurable:n,enumerable:r,writable:o},f?i(a(f),s):s},r.gs=function(e,t,n){var r,f,s,c;return"string"!=typeof e?(s=n,n=t,t=e,e=null):s=arguments[3],null==t?t=void 0:o(t)?null==n?n=void 0:o(n)||(s=n,n=void 0):(s=t,t=n=void 0),null==e?(r=!0,f=!1):(r=u.call(e,"c"),f=u.call(e,"e")),c={get:t,set:n,configurable:r,enumerable:f},s?i(a(s),c):c}},{"es5-ext/object/assign":4,"es5-ext/object/is-callable":7,"es5-ext/object/normalize-options":11,"es5-ext/string/#/contains":14}],4:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":5,"./shim":6}],5:[function(e,t,n){"use strict";t.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],6:[function(e,t,n){"use strict";var r=e("../keys"),i=e("../valid-value"),a=Math.max;t.exports=function(e,t){var n,o,u,f=a(arguments.length,2);for(e=Object(i(e)),u=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},o=1;o<f;++o)t=arguments[o],r(t).forEach(u);if(void 0!==n)throw n;return e}},{"../keys":8,"../valid-value":13}],7:[function(e,t,n){"use strict";t.exports=function(e){return"function"==typeof e}},{}],8:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":9,"./shim":10}],9:[function(e,t,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],10:[function(e,t,n){"use strict";var r=Object.keys;t.exports=function(e){return r(null==e?e:Object(e))}},{}],11:[function(e,t,n){"use strict";var r=Array.prototype.forEach,i=Object.create,a=function(e,t){var n;for(n in e)t[n]=e[n]};t.exports=function(e){var t=i(null);return r.call(arguments,function(e){null!=e&&a(Object(e),t)}),t}},{}],12:[function(e,t,n){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],13:[function(e,t,n){"use strict";t.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}},{}],14:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":15,"./shim":16}],15:[function(e,t,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(r.contains("dwa")===!0&&r.contains("foo")===!1)}},{}],16:[function(e,t,n){"use strict";var r=String.prototype.indexOf;t.exports=function(e){return r.call(this,e,arguments[1])>-1}},{}],17:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],f=t[6],s=t[7],c=t[8],l=t[9],p=t[10],h=t[11],d=t[12],m=t[13],b=t[14],y=t[15];return e[0]=u*(p*y-h*b)-l*(f*y-s*b)+m*(f*h-s*p),e[1]=-(r*(p*y-h*b)-l*(i*y-a*b)+m*(i*h-a*p)),e[2]=r*(f*y-s*b)-u*(i*y-a*b)+m*(i*s-a*f),e[3]=-(r*(f*h-s*p)-u*(i*h-a*p)+l*(i*s-a*f)),e[4]=-(o*(p*y-h*b)-c*(f*y-s*b)+d*(f*h-s*p)),e[5]=n*(p*y-h*b)-c*(i*y-a*b)+d*(i*h-a*p),e[6]=-(n*(f*y-s*b)-o*(i*y-a*b)+d*(i*s-a*f)),e[7]=n*(f*h-s*p)-o*(i*h-a*p)+c*(i*s-a*f),e[8]=o*(l*y-h*m)-c*(u*y-s*m)+d*(u*h-s*l),e[9]=-(n*(l*y-h*m)-c*(r*y-a*m)+d*(r*h-a*l)),e[10]=n*(u*y-s*m)-o*(r*y-a*m)+d*(r*s-a*u),e[11]=-(n*(u*h-s*l)-o*(r*h-a*l)+c*(r*s-a*u)),e[12]=-(o*(l*b-p*m)-c*(u*b-f*m)+d*(u*p-f*l)),e[13]=n*(l*b-p*m)-c*(r*b-i*m)+d*(r*p-i*l),e[14]=-(n*(u*b-f*m)-o*(r*b-i*m)+d*(r*f-i*u)),e[15]=n*(u*p-f*l)-o*(r*p-i*l)+c*(r*f-i*u),e}t.exports=r},{}],18:[function(e,t,n){function r(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=r},{}],19:[function(e,t,n){function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],20:[function(e,t,n){function r(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],21:[function(e,t,n){function r(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],u=e[6],f=e[7],s=e[8],c=e[9],l=e[10],p=e[11],h=e[12],d=e[13],m=e[14],b=e[15],y=t*o-n*a,g=t*u-r*a,v=t*f-i*a,x=n*u-r*o,w=n*f-i*o,k=r*f-i*u,A=s*d-c*h,j=s*m-l*h,E=s*b-p*h,_=c*m-l*d,T=c*b-p*d,D=l*b-p*m;return y*D-g*T+v*_+x*E-w*j+k*A}t.exports=r},{}],22:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,u=r+r,f=i+i,s=n*o,c=r*o,l=r*u,p=i*o,h=i*u,d=i*f,m=a*o,b=a*u,y=a*f;return e[0]=1-l-d,e[1]=c+y,e[2]=p-b,e[3]=0,e[4]=c-y,e[5]=1-s-d,e[6]=h+m,e[7]=0,e[8]=p+b,e[9]=h-m,e[10]=1-s-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],23:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],u=r+r,f=i+i,s=a+a,c=r*u,l=r*f,p=r*s,h=i*f,d=i*s,m=a*s,b=o*u,y=o*f,g=o*s;return e[0]=1-(h+m),e[1]=l+g,e[2]=p-y,e[3]=0,e[4]=l-g,e[5]=1-(c+m),e[6]=d+b,e[7]=0,e[8]=p+y,e[9]=d-b,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}t.exports=r},{}],24:[function(e,t,n){function r(e,t,n,r,i,a,o){var u=1/(n-t),f=1/(i-r),s=1/(a-o);return e[0]=2*a*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*f,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(i+r)*f,e[10]=(o+a)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*s,e[15]=0,e}t.exports=r},{}],25:[function(e,t,n){function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}t.exports=r},{}],26:[function(e,t,n){t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":17,"./clone":18,"./copy":19,"./create":20,"./determinant":21,"./fromQuat":22,"./fromRotationTranslation":23,"./frustum":24,"./identity":25,"./invert":27,"./lookAt":28,"./multiply":29,"./ortho":30,"./perspective":31,"./perspectiveFromFieldOfView":32,"./rotate":33,"./rotateX":34,"./rotateY":35,"./rotateZ":36,"./scale":37,"./str":38,"./translate":39,"./transpose":40}],27:[function(e,t,n){function r(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],f=t[6],s=t[7],c=t[8],l=t[9],p=t[10],h=t[11],d=t[12],m=t[13],b=t[14],y=t[15],g=n*u-r*o,v=n*f-i*o,x=n*s-a*o,w=r*f-i*u,k=r*s-a*u,A=i*s-a*f,j=c*m-l*d,E=c*b-p*d,_=c*y-h*d,T=l*b-p*m,D=l*y-h*m,O=p*y-h*b,S=g*O-v*D+x*T+w*_-k*E+A*j;return S?(S=1/S,e[0]=(u*O-f*D+s*T)*S,e[1]=(i*D-r*O-a*T)*S,e[2]=(m*A-b*k+y*w)*S,e[3]=(p*k-l*A-h*w)*S,e[4]=(f*_-o*O-s*E)*S,e[5]=(n*O-i*_+a*E)*S,e[6]=(b*x-d*A-y*v)*S,e[7]=(c*A-p*x+h*v)*S,e[8]=(o*D-u*_+s*j)*S,e[9]=(r*_-n*D-a*j)*S,e[10]=(d*k-m*x+y*g)*S,e[11]=(l*x-c*k-h*g)*S,e[12]=(u*E-o*T-f*j)*S,e[13]=(n*T-r*E+i*j)*S,e[14]=(m*v-d*w-b*g)*S,e[15]=(c*w-l*v+p*g)*S,e):null}t.exports=r},{}],28:[function(e,t,n){function r(e,t,n,r){var a,o,u,f,s,c,l,p,h,d,m=t[0],b=t[1],y=t[2],g=r[0],v=r[1],x=r[2],w=n[0],k=n[1],A=n[2];return Math.abs(m-w)<1e-6&&Math.abs(b-k)<1e-6&&Math.abs(y-A)<1e-6?i(e):(l=m-w,p=b-k,h=y-A,d=1/Math.sqrt(l*l+p*p+h*h),l*=d,p*=d,h*=d,a=v*h-x*p,o=x*l-g*h,u=g*p-v*l,d=Math.sqrt(a*a+o*o+u*u),d?(d=1/d,a*=d,o*=d,u*=d):(a=0,o=0,u=0),f=p*u-h*o,s=h*a-l*u,c=l*o-p*a,d=Math.sqrt(f*f+s*s+c*c),d?(d=1/d,f*=d,s*=d,c*=d):(f=0,s=0,c=0),e[0]=a,e[1]=f,e[2]=l,e[3]=0,e[4]=o,e[5]=s,e[6]=p,e[7]=0,e[8]=u,e[9]=c,e[10]=h,e[11]=0,e[12]=-(a*m+o*b+u*y),e[13]=-(f*m+s*b+c*y),e[14]=-(l*m+p*b+h*y),e[15]=1,e)}var i=e("./identity");t.exports=r},{"./identity":25}],29:[function(e,t,n){function r(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],u=t[4],f=t[5],s=t[6],c=t[7],l=t[8],p=t[9],h=t[10],d=t[11],m=t[12],b=t[13],y=t[14],g=t[15],v=n[0],x=n[1],w=n[2],k=n[3];return e[0]=v*r+x*u+w*l+k*m,e[1]=v*i+x*f+w*p+k*b,e[2]=v*a+x*s+w*h+k*y,e[3]=v*o+x*c+w*d+k*g,v=n[4],x=n[5],w=n[6],k=n[7],e[4]=v*r+x*u+w*l+k*m,e[5]=v*i+x*f+w*p+k*b,e[6]=v*a+x*s+w*h+k*y,e[7]=v*o+x*c+w*d+k*g,v=n[8],x=n[9],w=n[10],k=n[11],e[8]=v*r+x*u+w*l+k*m,e[9]=v*i+x*f+w*p+k*b,e[10]=v*a+x*s+w*h+k*y,e[11]=v*o+x*c+w*d+k*g,v=n[12],x=n[13],w=n[14],k=n[15],e[12]=v*r+x*u+w*l+k*m,e[13]=v*i+x*f+w*p+k*b,e[14]=v*a+x*s+w*h+k*y,e[15]=v*o+x*c+w*d+k*g,e}t.exports=r},{}],30:[function(e,t,n){function r(e,t,n,r,i,a,o){var u=1/(t-n),f=1/(r-i),s=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*s,e[11]=0,e[12]=(t+n)*u,e[13]=(i+r)*f,e[14]=(o+a)*s,e[15]=1,e}t.exports=r},{}],31:[function(e,t,n){function r(e,t,n,r,i){var a=1/Math.tan(t/2),o=1/(r-i);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*o,e[15]=0,e}t.exports=r},{}],32:[function(e,t,n){function r(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),f=2/(o+u),s=2/(i+a);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=-((o-u)*f*.5),e[9]=(i-a)*s*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}t.exports=r},{}],33:[function(e,t,n){function r(e,t,n,r){var i,a,o,u,f,s,c,l,p,h,d,m,b,y,g,v,x,w,k,A,j,E,_,T,D=r[0],O=r[1],S=r[2],C=Math.sqrt(D*D+O*O+S*S);return Math.abs(C)<1e-6?null:(C=1/C,D*=C,O*=C,S*=C,i=Math.sin(n),a=Math.cos(n),o=1-a,u=t[0],f=t[1],s=t[2],c=t[3],l=t[4],p=t[5],h=t[6],d=t[7],m=t[8],b=t[9],y=t[10],g=t[11],v=D*D*o+a,x=O*D*o+S*i,w=S*D*o-O*i,k=D*O*o-S*i,A=O*O*o+a,j=S*O*o+D*i,E=D*S*o+O*i,_=O*S*o-D*i,T=S*S*o+a,e[0]=u*v+l*x+m*w,e[1]=f*v+p*x+b*w,e[2]=s*v+h*x+y*w,e[3]=c*v+d*x+g*w,e[4]=u*k+l*A+m*j,e[5]=f*k+p*A+b*j,e[6]=s*k+h*A+y*j,e[7]=c*k+d*A+g*j,e[8]=u*E+l*_+m*T,e[9]=f*E+p*_+b*T,e[10]=s*E+h*_+y*T,e[11]=c*E+d*_+g*T,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}t.exports=r},{}],34:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],u=t[6],f=t[7],s=t[8],c=t[9],l=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+s*r,e[5]=o*i+c*r,e[6]=u*i+l*r,e[7]=f*i+p*r,e[8]=s*i-a*r,e[9]=c*i-o*r,e[10]=l*i-u*r,e[11]=p*i-f*r,e}t.exports=r},{}],35:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],u=t[2],f=t[3],s=t[8],c=t[9],l=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-s*r,e[1]=o*i-c*r,e[2]=u*i-l*r,e[3]=f*i-p*r,e[8]=a*r+s*i,e[9]=o*r+c*i,e[10]=u*r+l*i,e[11]=f*r+p*i,e}t.exports=r},{}],36:[function(e,t,n){function r(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],u=t[2],f=t[3],s=t[4],c=t[5],l=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+s*r,e[1]=o*i+c*r,e[2]=u*i+l*r,e[3]=f*i+p*r,e[4]=s*i-a*r,e[5]=c*i-o*r,e[6]=l*i-u*r,e[7]=p*i-f*r,e}t.exports=r},{}],37:[function(e,t,n){function r(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=r},{}],38:[function(e,t,n){function r(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}t.exports=r},{}],39:[function(e,t,n){function r(e,t,n){var r,i,a,o,u,f,s,c,l,p,h,d,m=n[0],b=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*b+t[8]*y+t[12],e[13]=t[1]*m+t[5]*b+t[9]*y+t[13],e[14]=t[2]*m+t[6]*b+t[10]*y+t[14],e[15]=t[3]*m+t[7]*b+t[11]*y+t[15]):(r=t[0],i=t[1],a=t[2],o=t[3],u=t[4],f=t[5],s=t[6],c=t[7],l=t[8],p=t[9],h=t[10],d=t[11],e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=f,e[6]=s,e[7]=c,e[8]=l,e[9]=p,e[10]=h,e[11]=d,e[12]=r*m+u*b+l*y+t[12],e[13]=i*m+f*b+p*y+t[13],e[14]=a*m+s*b+h*y+t[14],e[15]=o*m+c*b+d*y+t[15]),e}t.exports=r},{}],40:[function(e,t,n){function r(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}t.exports=r},{}],41:[function(e,t,n){"use strict";function r(e,t){function n(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==m.alt,m.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==m.shift,m.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==m.control,m.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==m.meta,m.meta=!!e.metaKey),t}function r(e,r){var a=i.x(r),o=i.y(r);"buttons"in r&&(e=0|r.buttons),(e!==p||a!==h||o!==d||n(r))&&(p=0|e,h=a||0,d=o||0,t&&t(p,h,d,m))}function a(e){r(0,e)}function o(){(p||h||d||m.shift||m.alt||m.meta||m.control)&&(h=d=0,p=0,m.shift=m.alt=m.control=m.meta=!1,t&&t(0,0,0,m))}function u(e){n(e)&&t&&t(p,h,d,m)}function f(e){0===i.buttons(e)?r(0,e):r(p,e)}function s(e){r(p|i.buttons(e),e)}function c(e){r(p&~i.buttons(e),e)}function l(){b||(b=!0,e.addEventListener("mousemove",f),e.addEventListener("mousedown",s),e.addEventListener("mouseup",c),e.addEventListener("mouseleave",a),e.addEventListener("mouseenter",a),e.addEventListener("mouseout",a),e.addEventListener("mouseover",a),e.addEventListener("blur",o),e.addEventListener("keyup",u),e.addEventListener("keydown",u),e.addEventListener("keypress",u),e!==window&&(window.addEventListener("blur",o),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}t||(t=e,e=window);var p=0,h=0,d=0,m={shift:!1,alt:!1,control:!1,meta:!1},b=!1;l();var y={element:e};return Object.defineProperties(y,{enabled:{get:function(){return b},set:function(e){e&&l()},enumerable:!0},buttons:{get:function(){return p},enumerable:!0},x:{get:function(){return h},enumerable:!0},y:{get:function(){return d},enumerable:!0},mods:{get:function(){return m},enumerable:!0}}),y}t.exports=r;var i=e("mouse-event")},{"mouse-event":43}],42:[function(e,t,n){function r(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,a=e.clientY||0,o=i(t);return n[0]=r-o.left,n[1]=a-o.top,n}function i(e){return e===window||e===document||e===document.body?a:e.getBoundingClientRect()}var a={left:0,top:0};t.exports=r},{}],43:[function(e,t,n){"use strict";function r(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0}function i(e){return e.target||e.srcElement||window}function a(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=i(e),n=t.getBoundingClientRect();return e.clientX-n.left}return 0}function o(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=i(e),n=t.getBoundingClientRect();return e.clientY-n.top}return 0}n.buttons=r,n.element=i,n.x=a,n.y=o},{}],44:[function(e,t,n){function r(e,t){for(var n=[],r=0;r<e.shape[0];r++)n.push(u(e.get(r),t.width));return n.join(" ")}function i(e,t){for(var n=[],i=0;i<e.shape[0];i++)n.push(r(e.pick(i,null),t));return n.join("\n")}function a(e,t){for(var n=[],r=0;r<e.shape[0];r++)n.push(i(e.pick(r,null,null),t),"");return n.join("\n")}function o(e,t){for(var n=[],r=3,i=0;i<e.shape[0];i++){var o=a(e.pick(i,null,null,null),t);n.push(o);for(var u=o.split("\n"),f=0;f<u.length;f++)r=Math.max(r,u[f].length)}return n.join("\n"+Array(r+1).join("-")+"\n\n")}var u=e("fixed-width-float"),f=e("ndarray");t.exports=function(e,t){return t||(t={}),"number"==typeof t&&(t={width:t}),t.width||(t.width=8),void 0===e.dimension&&(e=f(e)),1===e.dimension?r(e,t):2===e.dimension?i(e,t):3===e.dimension?a(e,t):4===e.dimension?o(e,t):void 0}},{"fixed-width-float":45,ndarray:47}],45:[function(e,t,n){function r(e,t){void 0===t&&(t=8);var n="%"+t+"."+t+"s";if(!(t<=0)){if(isNaN(e))return f(n,"NaN");if(e===1/0){if(1===t)return;return f(n,t>=9?"Infinity":" Inf").slice(0,t)}if(e===-(1/0)){if(1===t)return;return f(n,t>=9?"-Infinity":"-Inf").slice(0,t)}return u(e,t)}}function i(e,t){var n=Math.max(1,o(Math.abs(e))),r=o(Math.abs(n)),i=Math.pow(10,t+1);if(Math.abs(e)<1)e=Math.round(e*i)/i;else{var u=Math.pow(10,n+1);e=Math.round(e/u*i)/i*u}var s;if(t-r-6===-1)e=Math.round(e/Math.pow(10,n)),e*=Math.pow(10,n),s=f("%1e",e).replace(/\.[^e]+/,"");else{if(t-r-6<0)return;s=f("%."+(t-r-6)+"e",e)}return e>0&&(s=" "+s),a(s,t)}function a(e,t){return Array(Math.max(0,t-e.length+1)).join(" ")+e}function o(e){return Math.floor(Math.log(e)/Math.log(10))}function u(e,t){var n=Math.max(1,Math.floor((t-2)/2)),r=t-n-2;if(0===e&&t<4)return a("0",t);if(0===e)return a("0."+Array(r+1).join("0"),t);if(r<=0){var u=f("%"+n+"f",e);if(e>=0&&(u=" "+u),u.length>t)return;return a(u,t)}if(Math.abs(e)<Math.pow(10,1-r))return i(e,t);var s=Math.pow(10,t-3),c=Math.pow(10,o(Math.abs(e))),l=Math.round(e/c*s)/s*c,u=f("%"+n+"."+r+"f",l);l>0&&(u=" "+u),u=u.slice(0,t);var p=u.split(".")[1];return!p||p.length<1?i(l,t):a(u,t).slice(0,t)}var f=e("sprintf");t.exports=r},{sprintf:46}],46:[function(e,t,n){var r=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.object_stringify=function(e,t,r,i){var a="";if(null!=e)switch(typeof e){case"function":return"[Function"+(e.name?": "+e.name:"")+"]";case"object":if(e instanceof Error)return"["+e.toString()+"]";if(t>=r)return"[Object]";if(i&&(i=i.slice(0),i.push(e)),null!=e.length){a+="[";var o=[];for(var u in e)i&&i.indexOf(e[u])>=0?o.push("[Circular]"):o.push(n.object_stringify(e[u],t+1,r,i));a+=o.join(", ")+"]"}else{if("getMonth"in e)return"Date("+e+")";a+="{";var o=[];for(var f in e)e.hasOwnProperty(f)&&(i&&i.indexOf(e[f])>=0?o.push(f+": [Circular]"):o.push(f+": "+n.object_stringify(e[f],t+1,r,i)));a+=o.join(", ")+"}"}return a;case"string":return'"'+e+'"'}return""+e},n.format=function(i,a){var o,u,f,s,c,l,p,h=1,d=i.length,m="",b=[];for(u=0;u<d;u++)if(m=e(i[u]),"string"===m)b.push(i[u]);else if("array"===m){if(s=i[u],s[2])for(o=a[h],f=0;f<s[2].length;f++){if(!o.hasOwnProperty(s[2][f]))throw new Error(r('[sprintf] property "%s" does not exist',s[2][f]));o=o[s[2][f]]}else o=s[1]?a[s[1]]:a[h++];if(/[^sO]/.test(s[8])&&"number"!=e(o))throw new Error(r('[sprintf] expecting number but found %s "'+o+'"',e(o)));switch(s[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=s[7]?o.toExponential(s[7]):o.toExponential();break;case"f":o=s[7]?parseFloat(o).toFixed(s[7]):parseFloat(o);break;case"O":o=n.object_stringify(o,0,parseInt(s[7])||5);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&s[7]?o.substring(0,s[7]):o;break;case"u":o=Math.abs(o);break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(s[8])&&s[3]&&o>=0?"+"+o:o,l=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",p=s[6]-String(o).length,c=s[6]?t(l,p):"",b.push(s[5]?o+c:c+o)}return b.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosOuxX])/.exec(t)))throw new Error("[sprintf] "+t);if(n[2]){i|=1;var a=[],o=n[2],u=[];if(null===(u=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[sprintf] "+o);for(a.push(u[1]);""!==(o=o.substring(u[0].length));)if(null!==(u=/^\.([a-z_][a-z_\d]*)/i.exec(o)))a.push(u[1]);else{if(null===(u=/^\[(\d+)\]/.exec(o)))throw new Error("[sprintf] "+o);a.push(u[1])}n[2]=a}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push(n)}t=t.substring(n[0].length)}return r},n}(),i=function(e,t){var n=t.slice();return n.unshift(e),r.apply(null,n)};t.exports=r,r.sprintf=r,r.vsprintf=i},{}],47:[function(e,t,n){function r(e,t){return e[0]-t[0]}function i(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var i=new Array(n.length);for(e=0;e<i.length;++e)i[e]=n[e][1];return i}function a(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var r="generic"===e;if(t===-1){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",o=new Function(a);return o()}if(0===t){var a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",o=new Function("TrivialArray",a);return o(l[e][0])}var a=["'use strict'"],u=f(t),s=u.map(function(e){return"i"+e}),c="this.offset+"+u.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),p=u.map(function(e){return"b"+e}).join(","),h=u.map(function(e){return"c"+e}).join(",");a.push("function "+n+"(a,"+p+","+h+",d){this.data=a","this.shape=["+p+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+u.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+n+"_order(){"),2===t?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+s.join(",")+",v){"),r?a.push("return this.data.set("+c+",v)}"):a.push("return this.data["+c+"]=v}"),a.push("proto.get=function "+n+"_get("+s.join(",")+"){"),r?a.push("return this.data.get("+c+")}"):a.push("return this.data["+c+"]}"),a.push("proto.index=function "+n+"_index(",s.join(),"){return "+c+"}"),a.push("proto.hi=function "+n+"_hi("+s.join(",")+"){return new "+n+"(this.data,"+u.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+u.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var d=u.map(function(e){return"a"+e+"=this.shape["+e+"]"}),m=u.map(function(e){return"c"+e+"=this.stride["+e+"]"});a.push("proto.lo=function "+n+"_lo("+s.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+m.join(","));for(var b=0;b<t;++b)a.push("if(typeof i"+b+"==='number'&&i"+b+">=0){d=i"+b+"|0;b+=c"+b+"*d;a"+b+"-=d}");a.push("return new "+n+"(this.data,"+u.map(function(e){return"a"+e}).join(",")+","+u.map(function(e){return"c"+e}).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+s.join(",")+"){var "+u.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+u.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var b=0;b<t;++b)a.push("if(typeof i"+b+"==='number'){d=i"+b+"|0;if(d<0){c+=b"+b+"*(a"+b+"-1);a"+b+"=ceil(-a"+b+"/d)}else{a"+b+"=ceil(a"+b+"/d)}b"+b+"*=d}");a.push("return new "+n+"(this.data,"+u.map(function(e){return"a"+e}).join(",")+","+u.map(function(e){return"b"+e}).join(",")+",c)}");for(var y=new Array(t),g=new Array(t),b=0;b<t;++b)y[b]="a[i"+b+"]",g[b]="b[i"+b+"]";a.push("proto.transpose=function "+n+"_transpose("+s+"){"+s.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+y.join(",")+","+g.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+s+"){var a=[],b=[],c=this.offset");for(var b=0;b<t;++b)a.push("if(typeof i"+b+"==='number'&&i"+b+">=0){c=(c+this.stride["+b+"]*i"+b+")|0}else{a.push(this.shape["+b+"]);b.push(this.stride["+b+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+u.map(function(e){return"shape["+e+"]"}).join(",")+","+u.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",a.join("\n"));return o(l[e],i)}function o(e){if(s(e))return"buffer";if(c)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic";
}function u(e,t,n,r){if(void 0===e){var i=l.array[0];return i([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var u=t.length;if(void 0===n){n=new Array(u);for(var f=u-1,s=1;f>=0;--f)n[f]=s,s*=t[f]}if(void 0===r){r=0;for(var f=0;f<u;++f)n[f]<0&&(r-=(t[f]-1)*n[f])}for(var c=o(e),p=l[c];p.length<=u+1;)p.push(a(c,p.length-1));var i=p[u+1];return i(e,t,n,r)}var f=e("iota-array"),s=e("is-buffer"),c="undefined"!=typeof Float64Array,l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=u},{"iota-array":48,"is-buffer":49}],48:[function(e,t,n){"use strict";function r(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}t.exports=r},{}],49:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],50:[function(e,t,n){(function(r){!function(e){"object"==typeof n&&"undefined"!=typeof t?t.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this).createREGL=e()}(function(){return function t(n,r,i){function a(u,f){if(!r[u]){if(!n[u]){var s="function"==typeof e&&e;if(!f&&s)return s(u,!0);if(o)return o(u,!0);throw s=Error("Cannot find module '"+u+"'"),s.code="MODULE_NOT_FOUND",s}s=r[u]={exports:{}},n[u][0].call(s.exports,function(e){var t=n[u][1][e];return a(t?t:e)},s,s.exports,t,n,r,i)}return r[u].exports}for(var o="function"==typeof e&&e,u=0;u<i.length;u++)a(i[u]);return a}({1:[function(e,t,n){function r(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}t.exports=function(e,t,n,i,a){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new r;return{Record:r,scope:{},state:t}}},{}],2:[function(e,t,n){function r(e){return 0|p[Object.prototype.toString.call(e)]}function i(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function a(e,t,n,r,i,a,o){for(var u=0,f=0;f<n;++f)for(var s=0;s<r;++s)e[u++]=t[i*f+a*s+o]}var o=e("./util/is-typed-array"),u=e("./util/is-ndarray"),f=e("./util/values"),s=e("./util/pool");n=e("./util/flatten");var c=n.flatten,l=n.shape,p=e("./constants/arraytypes.json"),h=e("./constants/dtypes.json"),d=e("./constants/usage.json"),m=[];m[5120]=1,m[5122]=2,m[5124]=4,m[5121]=1,m[5123]=2,m[5125]=4,m[5126]=4,t.exports=function(e,t,n){function p(t){this.id=v++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function b(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function y(e,t,n,f,p,h){if(e.usage=n,Array.isArray(t)){if(e.dtype=f||5126,0<t.length)if(Array.isArray(t[0])){p=l(t);for(var d=f=1;d<p.length;++d)f*=p[d];e.dimension=f,t=c(t,p,e.dtype),b(e,t,n),h?e.persistentData=t:s.freeType(t)}else"number"==typeof t[0]?(e.dimension=p,p=s.allocType(e.dtype,t.length),i(p,t),b(e,p,n),h?e.persistentData=p:s.freeType(p)):o(t[0])&&(e.dimension=t[0].length,e.dtype=f||r(t[0])||5126,t=c(t,[t.length,t[0].length],e.dtype),b(e,t,n),h?e.persistentData=t:s.freeType(t))}else if(o(t))e.dtype=f||r(t),e.dimension=p,b(e,t,n),h&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(u(t)){p=t.shape;var m=t.stride,d=t.offset,y=0,g=0,v=0,x=0;1===p.length?(y=p[0],g=1,v=m[0],x=0):2===p.length&&(y=p[0],g=p[1],v=m[0],x=m[1]),e.dtype=f||r(t.data)||5126,e.dimension=g,p=s.allocType(e.dtype,y*g),a(p,t.data,y,g,v,x,d),b(e,p,n),h?e.persistentData=p:s.freeType(p)}}function g(n){t.bufferCount--,e.deleteBuffer(n.buffer),n.buffer=null,delete x[n.id]}var v=0,x={};p.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},p.prototype.destroy=function(){g(this)};var w=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(x).forEach(function(t){e+=x[t].stats.size}),e}),{create:function(f,b,v,w){function k(t){var r=35044,i=null,a=0,f=0,s=1;return Array.isArray(t)||o(t)||u(t)?i=t:"number"==typeof t?a=0|t:t&&("data"in t&&(i=t.data),"usage"in t&&(r=d[t.usage]),"type"in t&&(f=h[t.type]),"dimension"in t&&(s=0|t.dimension),"length"in t&&(a=0|t.length)),A.bind(),i?y(A,i,r,f,s,w):(e.bufferData(A.type,a,r),A.dtype=f||5121,A.usage=r,A.dimension=s,A.byteLength=a),n.profile&&(A.stats.size=A.byteLength*m[A.dtype]),k}t.bufferCount++;var A=new p(b);return x[A.id]=A,v||k(f),k._reglType="buffer",k._buffer=A,k.subdata=function(t,n){var f,p=0|(n||0);if(A.bind(),Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var h=s.allocType(A.dtype,t.length);i(h,t),e.bufferSubData(A.type,p,h),s.freeType(h)}else(Array.isArray(t[0])||o(t[0]))&&(f=l(t),h=c(t,f,A.dtype),e.bufferSubData(A.type,p,h),s.freeType(h))}else if(o(t))e.bufferSubData(A.type,p,t);else if(u(t)){f=t.shape;var d=t.stride,m=h=0,b=0,y=0;1===f.length?(h=f[0],m=1,b=d[0],y=0):2===f.length&&(h=f[0],m=f[1],b=d[0],y=d[1]),f=Array.isArray(t.data)?A.dtype:r(t.data),f=s.allocType(f,h*m),a(f,t.data,h,m,b,y,t.offset),e.bufferSubData(A.type,p,f),s.freeType(f)}return k},n.profile&&(k.stats=A.stats),k.destroy=function(){g(A)},k},createStream:function(e,t){var n=w.pop();return n||(n=new p(e)),n.bind(),y(n,t,35040,0,1,!1),n},destroyStream:function(e){w.push(e)},clear:function(){f(x).forEach(g),w.forEach(g)},getBuffer:function(e){return e&&e._buffer instanceof p?e._buffer:null},restore:function(){f(x).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:y}}},{"./constants/arraytypes.json":3,"./constants/dtypes.json":4,"./constants/usage.json":6,"./util/flatten":23,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],3:[function(e,t,n){t.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],4:[function(e,t,n){t.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126}},{}],5:[function(e,t,n){t.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],6:[function(e,t,n){t.exports={static:35044,dynamic:35048,stream:35040}},{}],7:[function(e,t,n){function r(e){return Array.isArray(e)||l(e)||p(e)}function i(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function a(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function o(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function u(e){return new a(!1,!1,!1,e)}function f(e,t){var n=e.type;return 0===n?(n=e.data.length,new a(!0,1<=n,2<=n,t)):4===n?(n=e.data,new a(n.thisDep,n.contextDep,n.propDep,t)):new a(3===n,2===n,1===n,t)}var s=e("./util/codegen"),c=e("./util/loop"),l=e("./util/is-typed-array"),p=e("./util/is-ndarray"),h=e("./util/is-array-like"),d=e("./dynamic"),m=e("./constants/primitives.json"),b=e("./constants/dtypes.json"),y=["x","y","z","w"],g="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),v={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},x={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},w={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},k={cw:2304,ccw:2305},A=new a(!1,!1,!1,function(){});t.exports=function(e,t,n,l,p,j,E,_,T,D,O,S,C,M,F){function z(e){return e.replace(".","_")}function L(e,t,n){var r=z(e);ge.push(e),ye[r]=be[r]=!!n,ve[r]=t}function B(e,t,n){var r=z(e);ge.push(e),Array.isArray(n)?(be[r]=n.slice(),ye[r]=n.slice()):be[r]=ye[r]=n,xe[r]=t}function P(){var e=s(),n=e.link,r=e.global;e.id=Ae++,e.batchId="0";var i=n(we),a=e.shared={props:"a0"};Object.keys(we).forEach(function(e){a[e]=r.def(i,".",e)});var o=e.next={},u=e.current={};Object.keys(xe).forEach(function(e){Array.isArray(be[e])&&(o[e]=r.def(a.next,".",e),u[e]=r.def(a.current,".",e))});var f=e.constants={};Object.keys(ke).forEach(function(e){f[e]=r.def(JSON.stringify(ke[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var i=["this",a.context,a.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(a.props,r.data);case 2:return t.def(a.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var c={};return e.scopeAttrib=function(e){if(e=t.id(e),e in c)return c[e];var r=D.scope[e];return r||(r=D.scope[e]=new pe),c[e]=n(r)},e}function I(e){var t=e.static;e=e.dynamic;var n;if("profile"in t){var r=!!t.profile;n=u(function(e,t){return r}),n.enable=r}else if("profile"in e){var i=e.profile;n=f(i,function(e,t){return e.invoke(t,i)})}return n}function R(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=_.getFramebuffer(i),u(function(e,t){var n=e.link(i),r=e.shared;return t.set(r.framebuffer,".next",n),r=r.context,t.set(r,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):u(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),n=n.context,t.set(n,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var a=r.framebuffer;return f(a,function(e,t){var n=e.invoke(t,a),r=e.shared,i=r.framebuffer,n=t.def(i,".getFramebuffer(",n,")");return t.set(i,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function H(e,t,n){function r(e){if(e in i){var n=i[e];e=!0;var r,u,s=0|n.x,c=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?u=0|n.height:e=!1,new a(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var i=e.shared.context,a=r;"width"in n||(a=t.def(i,".","framebufferWidth","-",s));var o=u;return"height"in n||(o=t.def(i,".","framebufferHeight","-",c)),[s,c,a,o]})}if(e in o){var l=o[e];return e=f(l,function(e,t){var n=e.invoke(t,l),r=e.shared.context,i=t.def(n,".x|0"),a=t.def(n,".y|0"),o=t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",a,")");return[i,a,o,n]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new a(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var i=e.static,o=e.dynamic;if(e=r("viewport")){var u=e;e=new a(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=u.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}function U(e){function n(e){if(e in r){var n=t.id(r[e]);return e=u(function(){return n}),e.id=n,e}if(e in i){var a=i[e];return f(a,function(e,t){var n=e.invoke(t,a);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,i=e.dynamic,s=n("frag"),c=n("vert"),l=null;return o(s)&&o(c)?(l=O.program(c.id,s.id),e=u(function(e,t){return e.link(l)})):e=new a(s&&s.thisDep||c&&c.thisDep,s&&s.contextDep||c&&c.contextDep,s&&s.propDep||c&&c.propDep,function(e,t){var n,r=e.shared.shader;n=s?s.append(e,t):t.def(r,".","frag");var i;return i=c?c.append(e,t):t.def(r,".","vert"),t.def(r+".program("+i+","+n+")")}),{frag:s,vert:c,progVar:e,program:l}}function W(e,t){function n(e,t){if(e in i){var n=0|i[e];return u(function(e,r){return t&&(e.OFFSET=n),n})}if(e in s){var r=s[e];return f(r,function(e,n){var i=e.invoke(n,r);return t&&(e.OFFSET=i),i})}return t&&c?u(function(e,t){return e.OFFSET="0",0}):null}var i=e.static,s=e.dynamic,c=function(){if("elements"in i){var e=i.elements;r(e)?e=j.getElements(j.create(e,!0)):e&&(e=j.getElements(e));var t=u(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in s){var n=s.elements;return f(n,function(e,t){var r=e.shared,i=r.isBufferArgs,r=r.elements,a=e.invoke(t,n),o=t.def("null"),i=t.def(i,"(",a,")"),a=e.cond(i).then(o,"=",r,".createStream(",a,");").else(o,"=",r,".getElements(",a,");");return t.entry(a),t.exit(e.cond(i).then(r,".destroyStream(",o,");")),e.ELEMENTS=o})}return null}(),l=n("offset",!0);return{elements:c,primitive:function(){if("primitive"in i){var e=i.primitive;return u(function(t,n){return m[e]})}if("primitive"in s){var t=s.primitive;return f(t,function(e,n){var r=e.constants.primTypes,i=e.invoke(n,t);return n.def(r,"[",i,"]")})}return c?o(c)?u(c.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return 4}):new a(c.thisDep,c.contextDep,c.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in i){var e=0|i.count;return u(function(){return e})}if("count"in s){var t=s.count;return f(t,function(e,n){return e.invoke(n,t)})}return c?o(c)?c?l?new a(l.thisDep,l.contextDep,l.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):u(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):u(function(){return-1}):new a(c.thisDep||l.thisDep,c.contextDep||l.contextDep,c.propDep||l.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:l}}function N(e,t){var n=e.static,r=e.dynamic,i={};return ge.forEach(function(e){function t(t,o){if(e in n){var s=t(n[e]);i[a]=u(function(){return s})}else if(e in r){var c=r[e];i[a]=f(c,function(e,t){return o(e,t,e.invoke(t,c))})}}var a=z(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return x[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return e=t.def("+",n,"[0]"),t=t.def("+",n,"[1]"),[e,t]});case"blend.func":return t(function(e){return[v["srcRGB"in e?e.srcRGB:e.src],v["dstRGB"in e?e.dstRGB:e.dst],v["srcAlpha"in e?e.srcAlpha:e.src],v["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var i=r("src","RGB"),a=r("dst","RGB"),i=t.def(e,"[",i,"]"),o=t.def(e,"[",r("src","Alpha"),"]"),a=t.def(e,"[",a,"]");return e=t.def(e,"[",r("dst","Alpha"),"]"),[i,a,o,e]});case"blend.equation":return t(function(e){return"string"==typeof e?[he[e],he[e]]:"object"==typeof e?[he[e.rgb],he[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),a=t.def();return e=e.cond("typeof ",n,'==="string"'),e.then(i,"=",a,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",a,"=",r,"[",n,".alpha];"),t(e),[i,a]});case"blend.color":return t(function(e){return c(4,function(t){return+e[t]})},function(e,t,n){return c(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[x[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680);var r=t.def(n,".ref|0");return t=t.def('"mask" in ',n,"?",n,".mask|0:-1"),[e,r,t]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,w[t.fail||"keep"],w[t.zfail||"keep"],w[t.zpass||"keep"]]},function(t,n,r){function i(e){return n.def('"',e,'" in ',r,"?",a,"[",r,".",e,"]:",7680)}var a=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,i("fail"),i("zfail"),i("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return e=t.def(n,".factor|0"),t=t.def(n,".units|0"),[e,t]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return k[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return c(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return e=t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert"),[e,t]})}}),i}function q(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=u(function(){return r});else if("function"==typeof r){var a=r._reglType;"texture2d"===a||"textureCube"===a?t=u(function(e){return e.link(r)}):"framebuffer"!==a&&"framebufferCube"!==a||(t=u(function(e){return e.link(r.color[0])}))}else h(r)&&(t=u(function(e){return e.global.def("[",c(r.length,function(e){return r[e]}),"]")}));t.value=r,i[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=f(t,function(e,n){return e.invoke(n,t)})}),i}function Q(e,n){var i=e.static,a=e.dynamic,o={};return Object.keys(i).forEach(function(e){var n=i[e],a=t.id(e),f=new pe;if(r(n))f.state=1,f.buffer=p.getBuffer(p.create(n,34962,!1,!0)),f.type=0;else{var s=p.getBuffer(n);if(s)f.state=1,f.buffer=s,f.type=0;else if(n.constant){var c=n.constant;f.buffer="null",f.state=2,"number"==typeof c?f.x=c:y.forEach(function(e,t){t<c.length&&(f[e]=c[t])})}else{var s=r(n.buffer)?p.getBuffer(p.create(n.buffer,34962,!1,!0)):p.getBuffer(n.buffer),l=0|n.offset,h=0|n.stride,d=0|n.size,m=!!n.normalized,g=0;"type"in n&&(g=b[n.type]),n=0|n.divisor,f.buffer=s,f.state=1,f.size=d,f.normalized=m,f.type=g||s.dtype,f.offset=l,f.stride=h,f.divisor=n}}o[e]=u(function(e,t){var n=e.attribCache;if(a in n)return n[a];var r={isStream:!1};return Object.keys(f).forEach(function(e){r[e]=f[e]}),f.buffer&&(r.buffer=e.link(f.buffer),r.type=r.type||r.buffer+".dtype"),n[a]=r})}),Object.keys(a).forEach(function(e){var t=a[e];o[e]=f(t,function(e,n){function r(e){n(f[e],"=",i,".",e,"|0;")}var i=e.invoke(n,t),a=e.shared,o=a.isBufferArgs,u=a.buffer,f={isStream:n.def(!1)},s=new pe;s.state=1,Object.keys(s).forEach(function(e){f[e]=n.def(""+s[e])});var c=f.buffer,l=f.type;return n("if(",o,"(",i,")){",f.isStream,"=true;",c,"=",u,".createStream(",34962,",",i,");",l,"=",c,".dtype;","}else{",c,"=",u,".getBuffer(",i,");","if(",c,"){",l,"=",c,".dtype;",'}else if("constant" in ',i,"){",f.state,"=",2,";","if(typeof "+i+'.constant === "number"){',f[y[0]],"=",i,".constant;",y.slice(1).map(function(e){return f[e]}).join("="),"=0;","}else{",y.map(function(e,t){return f[e]+"="+i+".constant.length>="+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",o,"(",i,".buffer)){",c,"=",u,".createStream(",34962,",",i,".buffer);","}else{",c,"=",u,".getBuffer(",i,".buffer);","}",l,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",c,".dtype;",f.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",f.isStream,"){",u,".destroyStream(",c,");","}"),f})}),o}function V(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=u(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=f(t,function(e,n){return e.invoke(n,t)})}),r}function X(e,t,n,r,i){var a=R(e,i),o=H(e,a,i),u=W(e,i),f=N(e,i),s=U(e,i),c=o.viewport;return c&&(f.viewport=c),c=z("scissor.box"),(o=o[c])&&(f[c]=o),o=0<Object.keys(f).length,a={framebuffer:a,draw:u,shader:s,state:f,dirty:o},a.profile=I(e,i),a.uniforms=q(n,i),a.attributes=Q(t,i),a.context=V(r,i),a}function Y(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(a){t.save(r,"."+a),i(r,".",a,"=",n[a].append(e,t),";")}),t(i)}function G(e,t,n,r){var i,a=e.shared,o=a.gl,u=a.framebuffer;me&&(i=t.def(a.extensions,".webgl_draw_buffers"));var f=e.constants,a=f.drawBuffer,f=f.backBuffer;e=n?n.append(e,t):t.def(u,".next"),r||t("if(",e,"!==",u,".cur){"),t("if(",e,"){",o,".bindFramebuffer(",36160,",",e,".framebuffer);"),me&&t(i,".drawBuffersWEBGL(",a,"[",e,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",36160,",null);"),me&&t(i,".drawBuffersWEBGL(",f,");"),t("}",u,".cur=",e,";"),r||t("}")}function K(e,t,n){var r=e.shared,i=r.gl,a=e.current,o=e.next,u=r.current,f=r.next,s=e.cond(u,".dirty");ge.forEach(function(t){if(t=z(t),!(t in n.state)){var r,l;if(t in o){r=o[t],l=a[t];var p=c(be[t].length,function(e){return s.def(r,"[",e,"]")});s(e.cond(p.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",xe[t],"(",p,");",p.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else r=s.def(f,".",t),p=e.cond(r,"!==",u,".",t),s(p),t in ve?p(e.cond(r).then(i,".enable(",ve[t],");").else(i,".disable(",ve[t],");"),u,".",t,"=",r,";"):p(i,".",xe[t],"(",r,");",u,".",t,"=",r,";")}}),0===Object.keys(n.state).length&&s(u,".dirty=false;"),t(s)}function Z(e,t,n,r){var a=e.shared,u=e.current,f=a.current,s=a.gl;i(Object.keys(n)).forEach(function(i){var a=n[i];if(!r||r(a)){var c=a.append(e,t);if(ve[i]){var l=ve[i];o(a)?c?t(s,".enable(",l,");"):t(s,".disable(",l,");"):t(e.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),t(f,".",i,"=",c,";")}else if(h(c)){var p=u[i];t(s,".",xe[i],"(",c,");",c.map(function(e,t){return p+"["+t+"]="+e}).join(";"),";")}else t(s,".",xe[i],"(",c,");",f,".",i,"=",c,";")}})}function $(e,t){de&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function J(e,t,n,r,i){function a(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function u(e){d=t.def(),e(d,"=",a(),";"),"string"==typeof i?e(l,".count+=",i,";"):e(l,".count++;"),M&&(r?(m=t.def(),e(m,"=",h,".getNumPendingQueries();")):e(h,".beginQuery(",l,");"))}function f(e){e(l,".cpuTime+=",a(),"-",d,";"),M&&(r?e(h,".pushScopeStats(",m,",",h,".getNumPendingQueries(),",l,");"):e(h,".endQuery();"))}function s(e){var n=t.def(p,".profile");t(p,".profile=",e,";"),t.exit(p,".profile=",n,";")}var c=e.shared,l=e.stats,p=c.current,h=c.timer;n=n.profile;var d,m;if(n){if(o(n))return void(n.enable?(u(t),f(t.exit),s("true")):s("false"));n=n.append(e,t),s(n)}else n=t.def(p,".profile");c=e.block(),u(c),t("if(",n,"){",c,"}"),e=e.block(),f(e),t.exit("if(",n,"){",e,"}")}function ee(e,t,n,r,i){function a(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function o(n,r,i){function a(){t("if(!",c,".buffer){",f,".enableVertexAttribArray(",s,");}");var n,a=i.type;n=i.size?t.def(i.size,"||",r):r,t("if(",c,".type!==",a,"||",c,".size!==",n,"||",h.map(function(e){return c+"."+e+"!=="+i[e]}).join("||"),"){",f,".bindBuffer(",34962,",",l,".buffer);",f,".vertexAttribPointer(",[s,n,a,i.normalized,i.stride,i.offset],");",c,".type=",a,";",c,".size=",n,";",h.map(function(e){return c+"."+e+"="+i[e]+";"}).join(""),"}"),de&&(a=i.divisor,t("if(",c,".divisor!==",a,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,a],");",c,".divisor=",a,";}"))}function o(){t("if(",c,".buffer){",f,".disableVertexAttribArray(",s,");","}if(",y.map(function(e,t){return c+"."+e+"!=="+p[t]}).join("||"),"){",f,".vertexAttrib4f(",s,",",p,");",y.map(function(e,t){return c+"."+e+"="+p[t]+";"}).join(""),"}")}var f=u.gl,s=t.def(n,".location"),c=t.def(u.attributes,"[",s,"]");n=i.state;var l=i.buffer,p=[i.x,i.y,i.z,i.w],h=["buffer","normalized","offset","stride"];1===n?a():2===n?o():(t("if(",n,"===",1,"){"),a(),t("}else{"),o(),t("}"))}var u=e.shared;r.forEach(function(r){var u,f=r.name,s=n.attributes[f];if(s){if(!i(s))return;u=s.append(e,t)}else{if(!i(A))return;var c=e.scopeAttrib(f);u={},Object.keys(new pe).forEach(function(e){u[e]=t.def(c,".",e)})}o(e.link(r),a(r.info.type),u)})}function te(e,n,r,i,a){for(var u,f=e.shared,s=f.gl,l=0;l<i.length;++l){var p,d=i[l],m=d.name,b=d.info.type,y=r.uniforms[m],d=e.link(d)+".location";if(y){if(!a(y))continue;if(o(y)){if(m=y.value,35678===b||35680===b)b=e.link(m._texture||m.color[0]._texture),n(s,".uniform1i(",d,",",b+".bind());"),n.exit(b,".unbind();");else if(35674===b||35675===b||35676===b)m=e.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),y=2,35675===b?y=3:35676===b&&(y=4),n(s,".uniformMatrix",y,"fv(",d,",false,",m,");");else{switch(b){case 5126:u="1f";break;case 35664:u="2f";break;case 35665:u="3f";break;case 35666:u="4f";break;case 35670:u="1i";break;case 5124:u="1i";break;case 35671:u="2i";break;case 35667:u="2i";break;case 35672:u="3i";break;case 35668:u="3i";break;case 35673:u="4i";break;case 35669:u="4i"}n(s,".uniform",u,"(",d,",",h(m)?Array.prototype.slice.call(m):m,");")}continue}p=y.append(e,n)}else{if(!a(A))continue;p=n.def(f.uniforms,"[",t.id(m),"]")}switch(35678===b?n("if(",p,"&&",p,'._reglType==="framebuffer"){',p,"=",p,".color[0];","}"):35680===b&&n("if(",p,"&&",p,'._reglType==="framebufferCube"){',p,"=",p,".color[0];","}"),m=1,b){case 35678:case 35680:b=n.def(p,"._texture"),n(s,".uniform1i(",d,",",b,".bind());"),n.exit(b,".unbind();");continue;case 5124:case 35670:u="1i";break;case 35667:case 35671:u="2i",m=2;break;case 35668:case 35672:u="3i",m=3;break;case 35669:case 35673:u="4i",m=4;break;case 5126:u="1f";break;case 35664:u="2f",m=2;break;case 35665:u="3f",m=3;break;case 35666:u="4f",m=4;break;case 35674:u="Matrix2fv";break;case 35675:u="Matrix3fv";break;case 35676:u="Matrix4fv"}if(n(s,".uniform",u,"(",d,","),"M"===u.charAt(0)){var d=Math.pow(b-35674+2,2),g=e.global.def("new Float32Array(",d,")");n("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",c(d,function(e){return g+"["+e+"]="+p+"["+e+"]"}),",",g,")")}else n(1<m?c(m,function(e){return p+"["+e+"]"}):p);n(");")}}function ne(e,t,n,r){function i(i){var a=l[i];return a?a.contextDep&&r.contextDynamic||a.propDep?a.append(e,n):a.append(e,t):t.def(c,".",i)}function a(){function e(){n(y,".drawElementsInstancedANGLE(",[h,m,g,d+"<<(("+g+"-5121)>>1)",b],");")}function t(){n(y,".drawArraysInstancedANGLE(",[h,d,m,b],");")}p?v?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}function u(){function e(){n(s+".drawElements("+[h,m,g,d+"<<(("+g+"-5121)>>1)"]+");")}function t(){n(s+".drawArrays("+[h,d,m]+");")}p?v?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}var f=e.shared,s=f.gl,c=f.draw,l=r.draw,p=function(){var i=l.elements,a=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(a=n),i=i.append(e,a)):i=a.def(c,".","elements"),i&&a("if("+i+")"+s+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),h=i("primitive"),d=i("offset"),m=function(){var i=l.count,a=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(a=n),i=i.append(e,a)):i=a.def(c,".","count"),i}();if("number"==typeof m){if(0===m)return}else n("if(",m,"){"),n.exit("}");var b,y;de&&(b=i("instances"),y=e.instancing);var g=p+".type",v=l.elements&&o(l.elements);de&&("number"!=typeof b||0<=b)?"string"==typeof b?(n("if(",b,">0){"),a(),n("}else if(",b,"<0){"),u(),n("}")):a():u()}function re(e,t,n,r,i){return t=P(),i=t.proc("body",i),de&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function ie(e,t,n,r){$(e,t),ee(e,t,n,r.attributes,function(){return!0}),te(e,t,n,r.uniforms,function(){return!0}),ne(e,t,t,n)}function ae(e,t){var n=e.proc("draw",1);$(e,n),Y(e,n,t.context),G(e,n,t.framebuffer),K(e,n,t),Z(e,n,t.state),J(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)ie(e,n,t,t.shader.program);else{var i=e.global.def("{}"),a=n.def(r,".id"),o=n.def(i,"[",a,"]");n(e.cond(o).then(o,".call(this,a0);").else(o,"=",i,"[",a,"]=",e.link(function(n){return re(ie,e,t,n,1)}),"(",r,");",o,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}function oe(e,t,n,r){function i(){return!0}e.batchId="a1",$(e,t),ee(e,t,n,r.attributes,i),te(e,t,n,r.uniforms,i),ne(e,t,t,n)}function ue(e,t,n,r){function i(e){return e.contextDep&&o||e.propDep}function a(e){return!i(e)}$(e,t);var o=n.contextDep,u=t.def(),f=t.def();e.shared.props=f,e.batchId=u;var s=e.scope(),c=e.scope();t(s.entry,"for(",u,"=0;",u,"<","a1",";++",u,"){",f,"=","a0","[",u,"];",c,"}",s.exit),n.needsContext&&Y(e,c,n.context),n.needsFramebuffer&&G(e,c,n.framebuffer),Z(e,c,n.state,i),n.profile&&i(n.profile)&&J(e,c,n,!1,!0),r?(ee(e,s,n,r.attributes,a),ee(e,c,n,r.attributes,i),te(e,s,n,r.uniforms,a),te(e,c,n,r.uniforms,i),ne(e,s,c,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,c),f=c.def(r,".id"),s=c.def(t,"[",f,"]"),c(e.shared.gl,".useProgram(",r,".program);","if(!",s,"){",s,"=",t,"[",f,"]=",e.link(function(t){return re(oe,e,n,t,2)}),"(",r,");}",s,".call(this,a0[",u,"],",u,");"))}function fe(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",$(e,r);var i=!1,a=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(Y(e,r,t.context),a=!1);var o=t.framebuffer,u=!1;if(o?(o.propDep?i=u=!0:o.contextDep&&i&&(u=!0),u||G(e,r,o)):G(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),K(e,r,t),Z(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||J(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=a,t.needsFramebuffer=u,a=t.shader.progVar,a.contextDep&&i||a.propDep)ue(e,r,t,null);else if(a=a.append(e,r),r(e.shared.gl,".useProgram(",a,".program);"),t.shader.program)ue(e,r,t,t.shader.program);else{var o=e.global.def("{}"),u=r.def(a,".id"),f=r.def(o,"[",u,"]");r(e.cond(f).then(f,".call(this,a0,a1);").else(f,"=",o,"[",u,"]=",e.link(function(n){return re(ue,e,t,n,2)}),"(",a,");",f,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}function se(e,n){function r(t){var r=n.shader[t];r&&a.set(o.shader,"."+t,r.append(e,a))}var a=e.proc("scope",3);e.batchId="a2";var o=e.shared,u=o.current;Y(e,a,n.context),n.framebuffer&&n.framebuffer.append(e,a),i(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,a);h(r)?r.forEach(function(n,r){a.set(e.next[t],"["+r+"]",n)}):a.set(o.next,"."+t,r)}),J(e,a,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&a.set(o.draw,"."+t,""+r.append(e,a))}),Object.keys(n.uniforms).forEach(function(r){a.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,a))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,a),i=e.scopeAttrib(t);Object.keys(new pe).forEach(function(e){a.set(i,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(a(u,".dirty=true;"),a.exit(u,".dirty=true;")),a("a1(",e.shared.context,",a0,",e.batchId,");")}function ce(e){if("object"==typeof e&&!h(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(d.isDynamic(e[t[n]]))return!0;return!1}}function le(e,t,n){function r(e,t){o.forEach(function(n){var r=i[n];d.isDynamic(r)&&(r=e.invoke(t,r),t(l,".",n,"=",r,";"))})}var i=t.static[n];if(i&&ce(i)){var a=e.global,o=Object.keys(i),u=!1,s=!1,c=!1,l=e.global.def("{}");o.forEach(function(t){var n=i[t];if(d.isDynamic(n))"function"==typeof n&&(n=i[t]=d.unbox(n)),t=f(n,null),u=u||t.thisDep,c=c||t.propDep,s=s||t.contextDep;else{
switch(a(l,".",t,"="),typeof n){case"number":a(n);break;case"string":a('"',n,'"');break;case"object":Array.isArray(n)&&a("[",n.join(),"]");break;default:a(e.link(n))}a(";")}}),t.dynamic[n]=new d.DynamicVariable(4,{thisDep:u,contextDep:s,propDep:c,ref:l,append:r}),delete t.static[n]}}var pe=D.Record,he={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(he.min=32775,he.max=32776);var de=n.angle_instanced_arrays,me=n.webgl_draw_buffers,be={dirty:!0,profile:F.profile},ye={},ge=[],ve={},xe={};L("dither",3024),L("blend.enable",3042),B("blend.color","blendColor",[0,0,0,0]),B("blend.equation","blendEquationSeparate",[32774,32774]),B("blend.func","blendFuncSeparate",[1,0,1,0]),L("depth.enable",2929,!0),B("depth.func","depthFunc",513),B("depth.range","depthRange",[0,1]),B("depth.mask","depthMask",!0),B("colorMask","colorMask",[!0,!0,!0,!0]),L("cull.enable",2884),B("cull.face","cullFace",1029),B("frontFace","frontFace",2305),B("lineWidth","lineWidth",1),L("polygonOffset.enable",32823),B("polygonOffset.offset","polygonOffset",[0,0]),L("sample.alpha",32926),L("sample.enable",32928),B("sample.coverage","sampleCoverage",[1,!1]),L("stencil.enable",2960),B("stencil.mask","stencilMask",-1),B("stencil.func","stencilFunc",[519,0,-1]),B("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),B("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),L("scissor.enable",3089),B("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),B("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var we={gl:e,context:C,strings:t,next:ye,current:be,draw:S,elements:j,buffer:p,shader:O,attributes:D.state,uniforms:T,framebuffer:_,extensions:n,timer:M,isBufferArgs:r},ke={primTypes:m,compareFuncs:x,blendFuncs:v,blendEquations:he,stencilOps:w,glTypes:b,orientationType:k};me&&(ke.backBuffer=[1029],ke.drawBuffer=c(l.maxDrawbuffers,function(e){return 0===e?[0]:c(e,function(e){return 36064+e})}));var Ae=0;return{next:ye,current:be,procs:function(){var t=P(),n=t.proc("poll"),r=t.proc("refresh"),i=t.block();n(i),r(i);var a=t.shared,o=a.gl,u=a.next,f=a.current;i(f,".dirty=false;"),G(t,n),G(t,r,null,!0);var s,p=e.getExtension("angle_instanced_arrays");p&&(s=t.link(p));for(var d=0;d<l.maxAttributes;++d){var m=r.def(a.attributes,"[",d,"]"),b=t.cond(m,".buffer");b.then(o,".enableVertexAttribArray(",d,");",o,".bindBuffer(",34962,",",m,".buffer.buffer);",o,".vertexAttribPointer(",d,",",m,".size,",m,".type,",m,".normalized,",m,".stride,",m,".offset);").else(o,".disableVertexAttribArray(",d,");",o,".vertexAttrib4f(",d,",",m,".x,",m,".y,",m,".z,",m,".w);",m,".buffer=null;"),r(b),p&&r(s,".vertexAttribDivisorANGLE(",d,",",m,".divisor);")}return Object.keys(ve).forEach(function(e){var a=ve[e],s=i.def(u,".",e),c=t.block();c("if(",s,"){",o,".enable(",a,")}else{",o,".disable(",a,")}",f,".",e,"=",s,";"),r(c),n("if(",s,"!==",f,".",e,"){",c,"}")}),Object.keys(xe).forEach(function(e){var a,s,l=xe[e],p=be[e],d=t.block();d(o,".",l,"("),h(p)?(l=p.length,a=t.global.def(u,".",e),s=t.global.def(f,".",e),d(c(l,function(e){return a+"["+e+"]"}),");",c(l,function(e){return s+"["+e+"]="+a+"["+e+"];"}).join("")),n("if(",c(l,function(e){return a+"["+e+"]!=="+s+"["+e+"]"}).join("||"),"){",d,"}")):(a=i.def(u,".",e),s=i.def(f,".",e),d(a,");",f,".",e,"=",a,";"),n("if(",a,"!==",s,"){",d,"}")),r(d)}),t.compile()}(),compile:function(e,t,n,r,i){var a=P();return a.stats=a.link(i),Object.keys(t.static).forEach(function(e){le(a,t,e)}),g.forEach(function(t){le(a,e,t)}),n=X(e,t,n,r,a),ae(a,n),se(a,n),fe(a,n),a.compile()}}}},{"./constants/dtypes.json":4,"./constants/primitives.json":5,"./dynamic":8,"./util/codegen":21,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],8:[function(e,t,n){function r(e,t){this.id=o++,this.type=e,this.data=t}function i(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(1<e.length&&t===n&&('"'===t||"'"===t))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(t=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return i(e.substr(0,t.index)).concat(i(t[1])).concat(i(e.substr(t.index+t[0].length)));if(t=e.split("."),1===t.length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(e=[],n=0;n<t.length;++n)e=e.concat(i(t[n]));return e}function a(e){return"["+i(e).join("][")+"]"}var o=0;t.exports={DynamicVariable:r,define:function(e,t){return new r(e,a(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof r},unbox:function(e,t){return"function"==typeof e?new r(0,e):e},accessor:a}},{}],9:[function(e,t,n){var r=e("./util/is-typed-array"),i=e("./util/is-ndarray"),a=e("./util/values"),o=e("./constants/primitives.json"),u=e("./constants/usage.json");t.exports=function(e,t,n,f){function s(e){this.id=h++,p[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function c(a,o,u,f,s,c,l){if(a.buffer.bind(),o){var p=l;l||r(o)&&(!i(o)||r(o.data))||(p=t.oes_element_index_uint?5125:5123),n._initBuffer(a.buffer,o,u,p,3)}else e.bufferData(34963,c,u),a.buffer.dtype=p||5121,a.buffer.usage=u,a.buffer.dimension=3,a.buffer.byteLength=c;if(p=l,!l){switch(a.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125}a.buffer.dtype=p}a.type=p,o=s,0>o&&(o=a.buffer.byteLength,5123===p?o>>=1:5125===p&&(o>>=2)),a.vertCount=o,o=f,0>f&&(o=4,f=a.buffer.dimension,1===f&&(o=0),2===f&&(o=1),3===f&&(o=4)),a.primType=o}function l(e){f.elementsCount--,delete p[e.id],e.buffer.destroy(),e.buffer=null}var p={},h=0,d={uint8:5121,uint16:5123};t.oes_element_index_uint&&(d.uint32=5125),s.prototype.bind=function(){this.buffer.bind()};var m=[];return{create:function(e,t){function a(e){if(e)if("number"==typeof e)p(e),h.primType=4,h.vertCount=0|e,h.type=5121;else{var t=null,n=35044,f=-1,s=-1,l=0,m=0;Array.isArray(e)||r(e)||i(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=u[e.usage]),"primitive"in e&&(f=o[e.primitive]),"count"in e&&(s=0|e.count),"type"in e&&(m=d[e.type]),"length"in e?l=0|e.length:(l=s,5123===m||5122===m?l*=2:5125!==m&&5124!==m||(l*=4))),c(h,t,n,f,s,l,m)}else p(),h.primType=4,h.vertCount=0,h.type=5121;return a}var p=n.create(null,34963,!0),h=new s(p._buffer);return f.elementsCount++,a(e),a._reglType="elements",a._elements=h,a.subdata=function(e,t){return p.subdata(e,t),a},a.destroy=function(){l(h)},a},createStream:function(e){var t=m.pop();return t||(t=new s(n.create(null,34963,!0,!1)._buffer)),c(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){m.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof s?e._elements:null},clear:function(){a(p).forEach(l)}}}},{"./constants/primitives.json":5,"./constants/usage.json":6,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],10:[function(e,t,n){t.exports=function(e,t){function n(t){t=t.toLowerCase();var n;try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var a=t.extensions[i];if(!n(a))return t.onDestroy(),t.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw Error("(regl): error restoring extension "+e)})}}}},{}],11:[function(e,t,n){var r=e("./util/values"),i=e("./util/extend"),a=[];a[6408]=4;var o=[];o[5121]=1,o[5126]=4,o[36193]=2,t.exports=function(e,t,n,u,f,s){function c(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function l(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function p(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function h(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function d(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),e=i._reglType,"texture2d"===e?n=i:"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new c(t,n,r)}function m(e,t,n,r,i){return n?(e=u.create2D({width:e,height:t,format:r,type:i}),e._texture.refCount=0,new c(3553,e,null)):(e=f.create({width:e,height:t,format:r}),e._renderbuffer.refCount=0,new c(36161,null,e))}function b(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function g(){this.id=T++,D[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(e){e.colorAttachments.forEach(l),l(e.depthAttachment),l(e.stencilAttachment),l(e.depthStencilAttachment)}function x(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,s.framebufferCount--,delete D[t.id]}function w(t){var r;e.bindFramebuffer(36160,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)h(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),h(36096,t.depthAttachment),h(36128,t.stencilAttachment),h(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.bindFramebuffer(36160,A.next),A.cur=A.next,e.getError()}function k(e,t){function n(e,t){var i,u=0,f=0,s=!0,c=!0;i=null;var l=!0,h="rgba",y="uint8",g=1,x=null,k=null,A=null,_=!1;"number"==typeof e?(u=0|e,f=0|t||u):e?("shape"in e?(f=e.shape,u=f[0],f=f[1]):("radius"in e&&(u=f=e.radius),"width"in e&&(u=e.width),"height"in e&&(f=e.height)),("color"in e||"colors"in e)&&(i=e.color||e.colors,Array.isArray(i)),i||("colorCount"in e&&(g=0|e.colorCount),"colorTexture"in e&&(l=!!e.colorTexture,h="rgba4"),"colorType"in e&&(y=e.colorType,!l)&&("half float"===y||"float16"===y?h="rgba16f":"float"!==y&&"float32"!==y||(h="rgba32f")),"colorFormat"in e&&(h=e.colorFormat,0<=j.indexOf(h)?l=!0:0<=E.indexOf(h)&&(l=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(_=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(x=e.depth,c=!1)),"stencil"in e&&("boolean"==typeof e.stencil?c=e.stencil:(k=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=c=e.depthStencil:(A=e.depthStencil,c=s=!1))):u=f=1;var T=null,D=null,O=null,S=null;if(Array.isArray(i))T=i.map(d);else if(i)T=[d(i)];else for(T=Array(g),i=0;i<g;++i)T[i]=m(u,f,l,h,y);for(u=u||T[0].width,f=f||T[0].height,x?D=d(x):s&&!c&&(D=m(u,f,_,"depth","uint32")),k?O=d(k):c&&!s&&(O=m(u,f,!1,"stencil","uint8")),A?S=d(A):!x&&!k&&c&&s&&(S=m(u,f,_,"depth stencil","depth stencil")),s=null,i=0;i<T.length;++i)p(T[i],u,f),T[i]&&T[i].texture&&(c=a[T[i].texture._texture.format]*o[T[i].texture._texture.type],null===s&&(s=c));return p(D,u,f),p(O,u,f),p(S,u,f),v(r),r.width=u,r.height=f,r.colorAttachments=T,r.depthAttachment=D,r.stencilAttachment=O,r.depthStencilAttachment=S,n.color=T.map(b),n.depth=b(D),n.stencil=b(O),n.depthStencil=b(S),n.width=r.width,n.height=r.height,w(r),n}var r=new g;return s.framebufferCount++,n(e,t),i(n,{resize:function(e,t){var i=0|e,a=0|t||i;if(i===r.width&&a===r.height)return n;for(var o=r.colorAttachments,u=0;u<o.length;++u)y(o[u],i,a);return y(r.depthAttachment,i,a),y(r.stencilAttachment,i,a),y(r.depthStencilAttachment,i,a),r.width=n.width=i,r.height=n.height=a,w(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){x(r),v(r)}})}var A={cur:null,next:null,dirty:!1},j=["rgba"],E=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&E.push("srgba"),t.ext_color_buffer_half_float&&E.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&E.push("rgba32f");var _=["uint8"];t.oes_texture_half_float&&_.push("half float","float16"),t.oes_texture_float&&_.push("float","float32");var T=0,D={};return i(A,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof g)?e:null},create:k,createCube:function(e){function t(e){var r,a={color:null},o=0,f=null;r="rgba";var s="uint8",c=1;if("number"==typeof e?o=0|e:e?("shape"in e?o=e.shape[0]:("radius"in e&&(o=0|e.radius),"width"in e?o=0|e.width:"height"in e&&(o=0|e.height)),("color"in e||"colors"in e)&&(f=e.color||e.colors,Array.isArray(f)),f||("colorCount"in e&&(c=0|e.colorCount),"colorType"in e&&(s=e.colorType),"colorFormat"in e&&(r=e.colorFormat)),"depth"in e&&(a.depth=e.depth),"stencil"in e&&(a.stencil=e.stencil),"depthStencil"in e&&(a.depthStencil=e.depthStencil)):o=1,f)if(Array.isArray(f))for(e=[],r=0;r<f.length;++r)e[r]=f[r];else e=[f];else for(e=Array(c),f={radius:o,format:r,type:s},r=0;r<c;++r)e[r]=u.createCube(f);for(a.color=Array(e.length),r=0;r<e.length;++r)c=e[r],o=o||c.width,a.color[r]={target:34069,data:e[r]};for(r=0;6>r;++r){for(c=0;c<e.length;++c)a.color[c].target=34069+r;0<r&&(a.depth=n[0].depth,a.stencil=n[0].stencil,a.depthStencil=n[0].depthStencil),n[r]?n[r](a):n[r]=k(a)}return i(t,{width:o,height:o,color:e})}var n=Array(6);return t(e),i(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){r(D).forEach(x)},restore:function(){r(D).forEach(function(t){t.framebuffer=e.createFramebuffer(),w(t)})}})}},{"./util/extend":22,"./util/values":31}],12:[function(e,t,n){t.exports=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;return t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}}},{}],13:[function(e,t,n){var r=e("./util/is-typed-array");t.exports=function(e,t,n,i,a,o){return function(a){var o;o=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var u=0,f=0,s=i.framebufferWidth,c=i.framebufferHeight,l=null;return r(a)?l=a:a&&(u=0|a.x,f=0|a.y,s=0|(a.width||i.framebufferWidth-u),c=0|(a.height||i.framebufferHeight-f),l=a.data||null),n(),a=s*c*4,l||(5121===o?l=new Uint8Array(a):5126===o&&(l=l||new Float32Array(a))),e.pixelStorei(3333,4),e.readPixels(u,f,s,c,6408,o,l),l}}},{"./util/is-typed-array":26}],14:[function(e,t,n){var r=e("./util/values"),i=[];i[32854]=2,i[32855]=2,i[36194]=2,i[33189]=2,i[36168]=1,i[34041]=4,i[35907]=4,i[34836]=16,i[34842]=8,i[34843]=6,t.exports=function(e,t,n,a,o){function u(e){this.id=l++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,o.profile&&(this.stats={size:0})}function f(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete p[t.id],a.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var c=[];Object.keys(s).forEach(function(e){c[s[e]]=e});var l=0,p={};return u.prototype.decRef=function(){0>=--this.refCount&&f(this)},o.profile&&(a.getTotalRenderbufferSize=function(){var e=0;return Object.keys(p).forEach(function(t){e+=p[t].stats.size}),e}),{create:function(t,n){function r(t,n){var a=0,u=0,l=32854;if("object"==typeof t&&t?("shape"in t?(u=t.shape,a=0|u[0],u=0|u[1]):("radius"in t&&(a=u=0|t.radius),"width"in t&&(a=0|t.width),"height"in t&&(u=0|t.height)),"format"in t&&(l=s[t.format])):"number"==typeof t?(a=0|t,u="number"==typeof n?0|n:a):t||(a=u=1),a!==f.width||u!==f.height||l!==f.format)return r.width=f.width=a,r.height=f.height=u,f.format=l,e.bindRenderbuffer(36161,f.renderbuffer),e.renderbufferStorage(36161,l,a,u),o.profile&&(f.stats.size=i[f.format]*f.width*f.height),r.format=c[f.format],r}var f=new u(e.createRenderbuffer());return p[f.id]=f,a.renderbufferCount++,r(t,n),r.resize=function(t,n){var a=0|t,u=0|n||a;return a===f.width&&u===f.height?r:(r.width=f.width=a,r.height=f.height=u,e.bindRenderbuffer(36161,f.renderbuffer),e.renderbufferStorage(36161,f.format,a,u),o.profile&&(f.stats.size=i[f.format]*f.width*f.height),r)},r._reglType="renderbuffer",r._renderbuffer=f,o.profile&&(r.stats=f.stats),r.destroy=function(){f.decRef()},r},clear:function(){r(p).forEach(f)},restore:function(){r(p).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}}},{"./util/values":31}],15:[function(e,t,n){var r=e("./util/values");t.exports=function(e,t,n,i){function a(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function u(n,r,i){i=35632===n?c:l;var a=i[r];if(!a){var o=t.str(r),a=e.createShader(n);e.shaderSource(a,o),e.compileShader(a),i[r]=a}return a}function f(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function s(n,r){var f,s;f=u(35632,n.fragId),s=u(35633,n.vertId);var c=n.program=e.createProgram();e.attachShader(c,f),e.attachShader(c,s),e.linkProgram(c);var l=e.getProgramParameter(c,35718);i.profile&&(n.stats.uniformsCount=l);var p=n.uniforms;for(f=0;f<l;++f)if(s=e.getActiveUniform(c,f))if(1<s.size)for(var h=0;h<s.size;++h){var d=s.name.replace("[0]","["+h+"]");o(p,new a(d,t.id(d),e.getUniformLocation(c,d),s))}else o(p,new a(s.name,t.id(s.name),e.getUniformLocation(c,s.name),s));for(l=e.getProgramParameter(c,35721),i.profile&&(n.stats.attributesCount=l),p=n.attributes,f=0;f<l;++f)(s=e.getActiveAttrib(c,f))&&o(p,new a(s.name,t.id(s.name),e.getAttribLocation(c,s.name),s))}var c={},l={},p={},h=[],d=0;return i.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);r(c).forEach(t),c={},r(l).forEach(t),l={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,p={},n.shaderCount=0},program:function(e,t,r){n.shaderCount++;var i=p[t];i||(i=p[t]={});var a=i[e];return a||(a=new f(t,e),s(a,r),i[e]=a,h.push(a)),a},restore:function(){c={},l={};for(var e=0;e<h.length;++e)s(h[e])},shader:u,frag:-1,vert:-1}}},{"./util/values":31}],16:[function(e,t,n){t.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],17:[function(e,t,n){t.exports=function(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r?r:(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}},{}],18:[function(e,t,n){function r(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function i(e){return!(!Array.isArray(e)||0===e.length||!m(e[0]))}function a(e){return Object.prototype.toString.call(e)}function o(e){if(!e)return!1;var t=a(e);return 0<=w.indexOf(t)||(r(e)||i(e)||p(e))}function u(e,t){36193===e.type?(e.data=d(t),h.freeType(t)):e.data=t}function f(e,t,n,r,i,a){if(e="undefined"!=typeof A[e]?A[e]:x[e]*k[t],a&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}var s=e("./util/extend"),c=e("./util/values"),l=e("./util/is-typed-array"),p=e("./util/is-ndarray"),h=e("./util/pool"),d=e("./util/to-half-float"),m=e("./util/is-array-like"),b=e("./util/flatten");n=e("./constants/arraytypes.json");var y=e("./constants/arraytypes.json"),g=[9984,9986,9985,9987],v=[0,6409,6410,6407,6408],x={};x[6409]=x[6406]=x[6402]=1,x[34041]=x[6410]=2,x[6407]=x[35904]=3,x[6408]=x[35906]=4;var w=Object.keys(n).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),k=[];k[5121]=1,k[5126]=4,k[36193]=2,k[5123]=2,k[5125]=4;var A=[];A[32854]=2,A[32855]=2,A[36194]=2,A[34041]=4,A[33776]=.5,A[33777]=.5,A[33778]=1,A[33779]=1,A[35986]=.5,A[35987]=1,A[34798]=1,A[35840]=.5,A[35841]=.25,A[35842]=.5,A[35843]=.25,A[36196]=.5,t.exports=function(e,t,n,w,k,A,j){function E(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.channels=this.height=this.width=this.colorSpace=0}function _(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function T(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=Z[t.colorSpace]),"type"in t&&(e.type=$[t.type]);var n=e.width,r=e.height,i=e.channels,a=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],a=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,a=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(n=t.format,r=e.internalformat=J[n],e.format=fe[r],n in $&&!("type"in t)&&(e.type=$[n]),n in ee&&(e.compressed=!0),n=!0),!a&&n?e.channels=x[e.format]:a&&!n&&e.channels!==v[e.format]&&(e.format=e.internalformat=v[e.channels])}}function D(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function O(){E.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function S(e,t){var n=null;if(o(t)?n=t:t&&(T(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),o(t.data)&&(n=t.data)),t.copy){var f=k.viewportWidth,s=k.viewportHeight;e.width=e.width||f-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0}else if(n){if(l(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|y[Object.prototype.toString.call(n)]);else if(r(n)){switch(e.channels=e.channels||4,f=n,s=f.length,e.type){case 5121:case 5123:case 5125:case 5126:s=h.allocType(e.type,s),s.set(f),e.data=s;break;case 36193:e.data=d(f)}e.alignment=1,e.needsFree=!0}else if(p(n)){f=n.data,Array.isArray(f)||5121!==e.type||(e.type=0|y[Object.prototype.toString.call(f)]);var c,g,x,w,s=n.shape,A=n.stride;3===s.length?(x=s[2],w=A[2]):w=x=1,c=s[0],g=s[1],s=A[0],A=A[1],e.alignment=1,e.width=c,e.height=g,e.channels=x,e.format=e.internalformat=v[x],e.needsFree=!0,c=w,n=n.offset,x=e.width,w=e.height,g=e.channels;for(var j=h.allocType(36193===e.type?5126:e.type,x*w*g),E=0,_=0;_<w;++_)for(var D=0;D<x;++D)for(var O=0;O<g;++O)j[E++]=f[s*D+A*_+c*O+n];u(e,j)}else if("[object HTMLCanvasElement]"===a(n)||"[object CanvasRenderingContext2D]"===a(n))"[object HTMLCanvasElement]"===a(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if("[object HTMLImageElement]"===a(n))e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if("[object HTMLVideoElement]"===a(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(i(n)){for(f=e.width||n[0].length,s=e.height||n.length,A=e.channels,A=m(n[0][0])?A||n[0][0].length:A||1,c=b.shape(n),x=1,w=0;w<c.length;++w)x*=c[w];x=h.allocType(36193===e.type?5126:e.type,x),b.flatten(n,c,"",x),u(e,x),e.alignment=1,e.width=f,e.height=s,e.channels=A,e.format=e.internalformat=v[A],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function C(t,n,r,i,a){var o=t.element,u=t.data,f=t.internalformat,s=t.format,c=t.type,l=t.width,p=t.height;D(t),o?e.texSubImage2D(n,a,r,i,s,c,o):t.compressed?e.compressedTexSubImage2D(n,a,r,i,f,l,p,u):t.needsCopy?(w(),e.copyTexSubImage2D(n,a,r,i,t.xOffset,t.yOffset,l,p)):e.texSubImage2D(n,a,r,i,l,p,s,c,u)}function M(){return se.pop()||new O}function F(e){e.needsFree&&h.freeType(e.data),O.call(e),se.push(e)}function z(){E.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function L(e,t,n){var r=e.images[0]=M();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function B(e,t){var n=null;if(o(t))n=e.images[0]=M(),_(n,e),S(n,t),e.mipmask=1;else if(T(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)n=e.images[i]=M(),_(n,e),n.width>>=i,n.height>>=i,S(n,r[i]),e.mipmask|=1<<i;else n=e.images[0]=M(),_(n,e),S(n,t),e.mipmask=1;_(e,e.images[0])}function P(t,n){for(var r=t.images,i=0;i<r.length&&r[i];++i){var a=r[i],o=n,u=i,f=a.element,s=a.data,c=a.internalformat,l=a.format,p=a.type,h=a.width,d=a.height;D(a),f?e.texImage2D(o,u,l,l,p,f):a.compressed?e.compressedTexImage2D(o,u,c,h,d,0,s):a.needsCopy?(w(),e.copyTexImage2D(o,u,l,a.xOffset,a.yOffset,h,d,0)):e.texImage2D(o,u,l,h,d,0,l,p,s)}}function I(){var e=ce.pop()||new z;E.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function R(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&F(t[n]),t[n]=null;ce.push(e)}function H(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function U(e,t){"min"in t&&(e.minFilter=K[t.min],0<=g.indexOf(e.minFilter)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=G[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var i=t.wrap;"string"==typeof i?n=r=Y[i]:Array.isArray(i)&&(n=Y[i[0]],r=Y[i[1]])}else"wrapS"in t&&(n=Y[t.wrapS]),"wrapT"in t&&(r=Y[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=X[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function W(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function N(t){E.call(this),this.mipmask=0,this.internalformat=6408,this.id=le++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,j.profile&&(this.stats={size:0})}function q(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function Q(){var t=de[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function V(t){var n=t.texture,r=t.unit,i=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(i,null),de[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete pe[t.id],A.textureCount--}var X={"don't care":4352,"dont care":4352,nice:4354,fast:4353},Y={repeat:10497,clamp:33071,mirror:33648},G={nearest:9728,linear:9729},K=s({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},G),Z={none:0,browser:37444},$={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},J={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ee={};t.ext_srgb&&(J.srgb=35904,J.srgba=35906),t.oes_texture_float&&($.float32=$.float=5126),t.oes_texture_half_float&&($.float16=$["half float"]=36193),t.webgl_depth_texture&&(s(J,{depth:6402,"depth stencil":34041}),s($,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&s(ee,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&s(ee,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&s(ee,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(ee["rgb etc1"]=36196);var te=Array.prototype.slice.call(e.getParameter(34467));Object.keys(ee).forEach(function(e){var t=ee[e];0<=te.indexOf(t)&&(J[e]=t)});var ne=Object.keys(J);n.textureFormats=ne;var re=[];Object.keys(J).forEach(function(e){re[J[e]]=e});var ie=[];Object.keys($).forEach(function(e){ie[$[e]]=e});var ae=[];Object.keys(G).forEach(function(e){ae[G[e]]=e});var oe=[];Object.keys(K).forEach(function(e){oe[K[e]]=e});var ue=[];Object.keys(Y).forEach(function(e){ue[Y[e]]=e});var fe=ne.reduce(function(e,t){var n=J[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),se=[],ce=[],le=0,pe={},he=n.maxTextureUnits,de=Array(he).map(function(){return null});return s(N.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<he;++n){var r=de[n];if(r){if(0<r.bindCount)continue;r.unit=-1}de[n]=this,t=n;break}j.profile&&A.maxTextureUnits<t+1&&(A.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&V(this)}}),j.profile&&(A.getTotalTextureSize=function(){var e=0;return Object.keys(pe).forEach(function(t){e+=pe[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=i.texInfo;H.call(n);var a=I();return"number"==typeof e?"number"==typeof t?L(a,0|e,0|t):L(a,0|e,0|e):e?(U(n,e),B(a,e)):L(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),i.mipmask=a.mipmask,_(i,a),i.internalformat=a.internalformat,r.width=a.width,r.height=a.height,q(i),P(a,3553),W(n,3553),Q(),R(a),j.profile&&(i.stats.size=f(i.internalformat,i.type,a.width,a.height,n.genMipmaps,!1)),r.format=re[i.internalformat],r.type=ie[i.type],r.mag=ae[n.magFilter],r.min=oe[n.minFilter],r.wrapS=ue[n.wrapS],r.wrapT=ue[n.wrapT],r}var i=new N(3553);return pe[i.id]=i,A.textureCount++,r(t,n),r.subimage=function(e,t,n,a){t|=0,n|=0,a|=0;var o=M();return _(o,i),o.width=0,o.height=0,S(o,e),o.width=o.width||(i.width>>a)-t,o.height=o.height||(i.height>>a)-n,q(i),C(o,3553,t,n,a),Q(),F(o),r},r.resize=function(t,n){var a=0|t,o=0|n||a;if(a===i.width&&o===i.height)return r;r.width=i.width=a,r.height=i.height=o,q(i);for(var u=0;i.mipmask>>u;++u)e.texImage2D(3553,u,i.format,a>>u,o>>u,0,i.format,i.type,null);return Q(),j.profile&&(i.stats.size=f(i.internalformat,i.type,a,o,!1,!1)),r},r._reglType="texture2d",r._texture=i,j.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(t,n,r,i,a,o){function u(e,t,n,r,i,a){var o,l=s.texInfo;for(H.call(l),o=0;6>o;++o)c[o]=I();if("number"!=typeof e&&e){if("object"==typeof e)if(t)B(c[0],e),B(c[1],t),B(c[2],n),B(c[3],r),B(c[4],i),B(c[5],a);else if(U(l,e),T(s,e),"faces"in e)for(e=e.faces,o=0;6>o;++o)_(c[o],s),B(c[o],e[o]);else for(o=0;6>o;++o)B(c[o],e)}else for(e=0|e||1,o=0;6>o;++o)L(c[o],e,e);for(_(s,c[0]),s.mipmask=l.genMipmaps?(c[0].width<<1)-1:c[0].mipmask,s.internalformat=c[0].internalformat,u.width=c[0].width,
u.height=c[0].height,q(s),o=0;6>o;++o)P(c[o],34069+o);for(W(l,34067),Q(),j.profile&&(s.stats.size=f(s.internalformat,s.type,u.width,u.height,l.genMipmaps,!0)),u.format=re[s.internalformat],u.type=ie[s.type],u.mag=ae[l.magFilter],u.min=oe[l.minFilter],u.wrapS=ue[l.wrapS],u.wrapT=ue[l.wrapT],o=0;6>o;++o)R(c[o]);return u}var s=new N(34067);pe[s.id]=s,A.cubeCount++;var c=Array(6);return u(t,n,r,i,a,o),u.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var a=M();return _(a,s),a.width=0,a.height=0,S(a,t),a.width=a.width||(s.width>>i)-n,a.height=a.height||(s.height>>i)-r,q(s),C(a,34069+e,n,r,i),Q(),F(a),u},u.resize=function(t){if(t|=0,t!==s.width){u.width=s.width=t,u.height=s.height=t,q(s);for(var n=0;6>n;++n)for(var r=0;s.mipmask>>r;++r)e.texImage2D(34069+n,r,s.format,t>>r,t>>r,0,s.format,s.type,null);return Q(),j.profile&&(s.stats.size=f(s.internalformat,s.type,u.width,u.height,!1,!0)),u}},u._reglType="textureCube",u._texture=s,j.profile&&(u.stats=s.stats),u.destroy=function(){s.decRef()},u},clear:function(){for(var t=0;t<he;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),de[t]=null;c(pe).forEach(V),A.cubeCount=0,A.textureCount=0},getTexture:function(e){return null},restore:function(){c(pe).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!==(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);W(t.texInfo,t.target)})}}}},{"./constants/arraytypes.json":3,"./util/extend":22,"./util/flatten":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],19:[function(e,t,n){t.exports=function(e,t){function n(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function r(e,t,r){var i=u.pop()||new n;i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=r,f.push(i)}var i=t.ext_disjoint_timer_query;if(!i)return null;var a=[],o=[],u=[],f=[],s=[],c=[];return{beginQuery:function(e){var t=a.pop()||i.createQueryEXT();i.beginQueryEXT(35007,t),o.push(t),r(o.length-1,o.length,e)},endQuery:function(){i.endQueryEXT(35007)},pushScopeStats:r,update:function(){var e,t;if(e=o.length,0!==e){c.length=Math.max(c.length,e+1),s.length=Math.max(s.length,e+1),s[0]=0;var n=c[0]=0;for(t=e=0;t<o.length;++t){var r=o[t];i.getQueryObjectEXT(r,34919)?(n+=i.getQueryObjectEXT(r,34918),a.push(r)):o[e++]=r,s[t+1]=n,c[t+1]=e}for(o.length=e,t=e=0;t<f.length;++t){var n=f[t],l=n.startQueryIndex,r=n.endQueryIndex;n.sum+=s[r]-s[l],l=c[l],r=c[r],r===l?(n.stats.gpuTime+=n.sum/1e6,u.push(n)):(n.startQueryIndex=l,n.endQueryIndex=r,f[e++]=n)}f.length=e}},getNumPendingQueries:function(){return o.length},clear:function(){a.push.apply(a,o);for(var e=0;e<a.length;e++)i.deleteQueryEXT(a[e]);o.length=0,a.length=0},restore:function(){o.length=0,a.length=0}}}},{}],20:[function(e,t,n){t.exports="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],21:[function(e,t,n){function r(e){return Array.prototype.slice.call(e)}function i(e){return r(e).join("")}var a=e("./extend");t.exports=function(){function e(){var e=[],t=[];return a(function(){e.push.apply(e,r(arguments))},{def:function(){var i="v"+n++;return t.push(i),0<arguments.length&&(e.push(i,"="),e.push.apply(e,r(arguments)),e.push(";")),i},toString:function(){return i([0<t.length?"var "+t+";":"",i(e)])}})}function t(){function t(e,t){i(e,t,"=",n.def(e,t),";")}var n=e(),i=e(),o=n.toString,u=i.toString;return a(function(){n.apply(n,r(arguments))},{def:n.def,entry:n,exit:i,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return o()+u()}})}var n=0,o=[],u=[],f=e(),s={};return{global:f,link:function(e){for(var t=0;t<u.length;++t)if(u[t]===e)return o[t];return t="g"+n++,o.push(t),u.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+o.length;return o.push(e),e}var o=[];n=n||0;for(var u=0;u<n;++u)r();var u=t(),f=u.toString;return s[e]=a(u,{arg:r,toString:function(){return i(["function(",o.join(),"){",f(),"}"])}})},scope:t,cond:function(){var e=i(arguments),n=t(),o=t(),u=n.toString,f=o.toString;return a(n,{then:function(){return n.apply(n,r(arguments)),this},else:function(){return o.apply(o,r(arguments)),this},toString:function(){var t=f();return t&&(t="else{"+t+"}"),i(["if(",e,"){",u(),"}",t])}})},compile:function(){var e=['"use strict";',f,"return {"];Object.keys(s).forEach(function(t){e.push('"',t,'":',s[t].toString(),",")}),e.push("}");var t=i(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,o.concat(t)).apply(null,u)}}}},{"./extend":22}],22:[function(e,t,n){t.exports=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e}},{}],23:[function(e,t,n){function r(e,t,n,r,i,a){for(var o=0;o<t;++o)for(var u=e[o],f=0;f<n;++f)for(var s=u[f],c=0;c<r;++c)i[a++]=s[c]}function i(e,t,n,a,o){for(var u=1,f=n+1;f<t.length;++f)u*=t[f];var s=t[n];if(4===t.length-n){var c=t[n+1],l=t[n+2];for(t=t[n+3],f=0;f<s;++f)r(e[f],c,l,t,a,o),o+=u}else for(f=0;f<s;++f)i(e[f],t,n+1,a,o),o+=u}var a=e("./pool");t.exports={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,o){var u=1;if(t.length)for(var f=0;f<t.length;++f)u*=t[f];else u=0;switch(n=o||a.allocType(n,u),t.length){case 0:break;case 1:for(o=t[0],t=0;t<o;++t)n[t]=e[t];break;case 2:for(o=t[0],t=t[1],f=u=0;f<o;++f)for(var s=e[f],c=0;c<t;++c)n[u++]=s[c];break;case 3:r(e,t[0],t[1],t[2],n,0);break;default:i(e,t,0,n,0)}return n}}},{"./pool":28}],24:[function(e,t,n){var r=e("./is-typed-array");t.exports=function(e){return Array.isArray(e)||r(e)}},{"./is-typed-array":26}],25:[function(e,t,n){var r=e("./is-typed-array");t.exports=function(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||r(e.data))}},{"./is-typed-array":26}],26:[function(e,t,n){var r=e("../constants/arraytypes.json");t.exports=function(e){return Object.prototype.toString.call(e)in r}},{"../constants/arraytypes.json":3}],27:[function(e,t,n){t.exports=function(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}},{}],28:[function(e,t,n){function r(e){var t,n;return t=(65535<e)<<4,e>>>=t,n=(255<e)<<3,e>>>=n,t|=n,n=(15<e)<<2,e>>>=n,t|=n,n=(3<e)<<1,t|n|e>>>n>>1}function i(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return t=o[r(e)>>2],0<t.length?t.pop():new ArrayBuffer(e)}function a(e){o[r(e.byteLength)>>2].push(e)}var o=e("./loop")(8,function(){return[]});t.exports={alloc:i,free:a,allocType:function(e,t){var n=null;switch(e){case 5120:n=new Int8Array(i(t),0,t);break;case 5121:n=new Uint8Array(i(t),0,t);break;case 5122:n=new Int16Array(i(2*t),0,t);break;case 5123:n=new Uint16Array(i(2*t),0,t);break;case 5124:n=new Int32Array(i(4*t),0,t);break;case 5125:n=new Uint32Array(i(4*t),0,t);break;case 5126:n=new Float32Array(i(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){a(e.buffer)}}},{"./loop":27}],29:[function(e,t,n){t.exports="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?{next:function(e){return requestAnimationFrame(e)},cancel:function(e){return cancelAnimationFrame(e)}}:{next:function(e){return setTimeout(e,16)},cancel:clearTimeout}},{}],30:[function(e,t,n){var r=e("./pool"),i=new Float32Array(1),a=new Uint32Array(i.buffer);t.exports=function(e){for(var t=r.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(1/0===e[n])t[n]=31744;else if(-(1/0)===e[n])t[n]=64512;else{i[0]=e[n];var o=a[0],u=o>>>31<<15,f=(o<<1>>>24)-127,o=o>>13&1023;t[n]=-24>f?u:-14>f?u+(o+1024>>-14-f):15<f?u+31744:u+(f+15<<10)+o}return t}},{"./pool":28}],31:[function(e,t,n){t.exports=function(e){return Object.keys(e).map(function(t){return e[t]})}},{}],32:[function(e,t,n){function r(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(r=e.getBoundingClientRect(),t=r.right-r.left,r=r.top-r.bottom),i.width=n*t,i.height=n*r,u(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return u(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",u(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}function i(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function a(e){return"string"==typeof e?e.split():e}function o(e){return"string"==typeof e?document.querySelector(e):e}var u=e("./util/extend");t.exports=function(e){var t,n,u,f,s=e||{};e={};var c=[],l=[],p="undefined"==typeof window?1:window.devicePixelRatio,h=!1,d=function(e){},m=function(){};if("string"==typeof s?t=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?(f=s,u=f.canvas):("gl"in s?f=s.gl:"canvas"in s?u=o(s.canvas):"container"in s&&(n=o(s.container)),"attributes"in s&&(e=s.attributes),"extensions"in s&&(c=a(s.extensions)),"optionalExtensions"in s&&(l=a(s.optionalExtensions)),"onDone"in s&&(d=s.onDone),"profile"in s&&(h=!!s.profile),"pixelRatio"in s&&(p=+s.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?u=t:n=t),!f){if(!u){if(t=r(n||document.body,d,p),!t)return null;u=t.canvas,m=t.onDestroy}f=i(u,e)}return f?{gl:f,canvas:u,container:n,extensions:c,optionalExtensions:l,pixelRatio:p,profile:h,onDone:d,onDestroy:m}:(m(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":22}],33:[function(e,t,n){function r(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var i=e("./lib/util/extend"),a=e("./lib/dynamic"),o=e("./lib/util/raf"),u=e("./lib/util/clock"),f=e("./lib/strings"),s=e("./lib/webgl"),c=e("./lib/extension"),l=e("./lib/limits"),p=e("./lib/buffer"),h=e("./lib/elements"),d=e("./lib/texture"),m=e("./lib/renderbuffer"),b=e("./lib/framebuffer"),y=e("./lib/attribute"),g=e("./lib/shader"),v=e("./lib/read"),x=e("./lib/core"),w=e("./lib/stats"),k=e("./lib/timer");t.exports=function(e){function t(){if(0===J.length)I&&I.update(),re=null;else{re=o.next(t),O();for(var e=J.length-1;0<=e;--e){var n=J[e];n&&n(W,null,0)}M.flush(),I&&I.update()}}function n(){!re&&0<J.length&&(re=o.next(t))}function A(){re&&(o.cancel(t),re=null)}function j(e){e.preventDefault(),A(),ee.forEach(function(e){e()})}function E(e){M.getError(),z.restore(),V.restore(),q.restore(),X.restore(),Y.restore(),G.restore(),I&&I.restore(),K.procs.refresh(),n(),te.forEach(function(e){e()})}function _(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];a.isDynamic(i)?n[r]=a.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}function n(e){for(;p.length<e;)p.push(null);return p}var r=t(e.context||{}),o=t(e.uniforms||{}),u=t(e.attributes||{}),f=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=i({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e));e={gpuTime:0,cpuTime:0,count:0};var r=K.compile(f,u,o,r,e),s=r.draw,c=r.batch,l=r.scope,p=[];return i(function(e,t){var r;if("function"==typeof e)return l.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(r=0;r<e;++r)l.call(this,null,t,r);else{if(!Array.isArray(e))return l.call(this,e,t,0);for(r=0;r<e.length;++r)l.call(this,e[r],t,r)}else if("number"==typeof e){if(0<e)return c.call(this,n(0|e),0|e)}else{if(!Array.isArray(e))return s.call(this,e);if(e.length)return c.call(this,e,e.length)}},{stats:e})}function T(e){return J.push(e),n(),{cancel:function(){function t(){var e=r(J,t);J[e]=J[J.length-1],--J.length,0>=J.length&&A()}var n=r(J,e);J[n]=t}}}function D(){var e=Z.viewport,t=Z.scissor_box;e[0]=e[1]=t[0]=t[1]=0,W.viewportWidth=W.framebufferWidth=W.drawingBufferWidth=e[2]=t[2]=M.drawingBufferWidth,W.viewportHeight=W.framebufferHeight=W.drawingBufferHeight=e[3]=t[3]=M.drawingBufferHeight}function O(){W.tick+=1,W.time=C(),D(),K.procs.poll()}function S(){D(),K.procs.refresh(),I&&I.update()}function C(){return(u()-R)/1e3}if(e=s(e),!e)return null;var M=e.gl,F=M.getContextAttributes();M.isContextLost();var z=c(M,e);if(!z)return null;var L=f(),B=w(),P=z.extensions,I=k(M,P),R=u(),H=M.drawingBufferWidth,U=M.drawingBufferHeight,W={tick:0,time:0,viewportWidth:H,viewportHeight:U,framebufferWidth:H,framebufferHeight:U,drawingBufferWidth:H,drawingBufferHeight:U,pixelRatio:e.pixelRatio},N=l(M,P),q=p(M,B,e),Q=h(M,P,q,B),H=y(M,P,N,q,L),V=g(M,L,B,e),X=d(M,P,N,function(){K.procs.poll()},W,B,e),Y=m(M,P,N,B,e),G=b(M,P,N,X,Y,B),K=x(M,L,P,N,q,Q,X,G,{},H,V,{elements:null,primitive:4,count:-1,offset:0,instances:-1},W,I,e),L=v(M,G,K.procs.poll,W,F,P),Z=K.next,$=M.canvas,J=[],ee=[],te=[],ne=[e.onDestroy],re=null;return $&&($.addEventListener("webglcontextlost",j,!1),$.addEventListener("webglcontextrestored",E,!1)),S(),F=i(_,{clear:function(e){var t=0;K.procs.poll();var n=e.color;n&&(M.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),t|=16384),"depth"in e&&(M.clearDepth(+e.depth),t|=256),"stencil"in e&&(M.clearStencil(0|e.stencil),t|=1024),M.clear(t)},prop:a.define.bind(null,1),context:a.define.bind(null,2),this:a.define.bind(null,3),draw:_({}),buffer:function(e){return q.create(e,34962,!1,!1)},elements:function(e){return Q.create(e,!1)},texture:X.create2D,cube:X.createCube,renderbuffer:Y.create,framebuffer:G.create,framebufferCube:G.createCube,attributes:F,frame:T,on:function(e,t){var n;switch(e){case"frame":return T(t);case"lost":n=ee;break;case"restore":n=te;break;case"destroy":n=ne}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:N,hasExtension:function(e){return 0<=N.extensions.indexOf(e.toLowerCase())},read:L,destroy:function(){J.length=0,A(),$&&($.removeEventListener("webglcontextlost",j),$.removeEventListener("webglcontextrestored",E)),V.clear(),G.clear(),Y.clear(),X.clear(),Q.clear(),q.clear(),I&&I.clear(),ne.forEach(function(e){e()})},_gl:M,_refresh:S,poll:function(){O(),I&&I.update()},now:C,stats:B}),e.onDone(null,F),F}},{"./lib/attribute":1,"./lib/buffer":2,"./lib/core":7,"./lib/dynamic":8,"./lib/elements":9,"./lib/extension":10,"./lib/framebuffer":11,"./lib/limits":12,"./lib/read":13,"./lib/renderbuffer":14,"./lib/shader":15,"./lib/stats":16,"./lib/strings":17,"./lib/texture":18,"./lib/timer":19,"./lib/util/clock":20,"./lib/util/extend":22,"./lib/util/raf":29,"./lib/webgl":32}]},{},[33])(33)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(e,t,n){function r(e,t){if(!t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}t.exports=r},{}],52:[function(e,t,n){function r(e,t,n,r,i,a,o){return e[0]=.5*r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=.5*i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=.5*(o-a),e[11]=0,e[12]=t+.5*r,e[13]=n+.5*i,e[14]=.5*(o+a),e[15]=1,e}t.exports=r},{}],53:[function(e,t,n){"use strict";window.interactionEvents=e("../../"),window.regl=e("regl"),window.mat4=e("gl-mat4"),window.mat4.viewport=e("../../viewport"),window.ndarray=e("ndarray"),window.show=e("ndarray-show"),window.extend=e("util-extend"),window.logshow=function(e,t){console.log(e+" =\n"+show(ndarray(t,[4,4])))}},{"../../":1,"../../viewport":52,"gl-mat4":26,ndarray:47,"ndarray-show":44,regl:50,"util-extend":51}]},{},[53]);
